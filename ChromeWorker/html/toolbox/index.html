<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
</head>
<body>
  <!-- ========= -->
  <!--   HTML    -->
  <!-- ========= -->


  
  <div id="container">
    <div id="expressioneditor-container">
    
    </div>
   <div id="containerdata" ></div>
   <div class="modal" id="RecourseModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title tr" id="myModalLabel">Select Resource</h4>
          </div>
          <div class="modal-body">
            <span id="RecourseControls">
              <select class="form-control" id="RecourseName" placeholder="Recourse Name">
              </select>
              <input type="checkbox" id="ResourceReuse" checked /> <label for="ResourceReuse" class="tr res-margin">Reuse Resource</label>
              <input type="checkbox" id="ResourceDontDie"/> <label for="ResourceDontDie" class="tr res-margin">Don't end application if not exists</label>
            </span>

            <span id="NoResources" class="tr">No resources found.</span>

          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-primary resok standartbutton tr" data-dismiss="modal">Ok</button>
            <button type="button" class="btn btn-default standartbutton tr" data-dismiss="modal">Cancel</button>
          </div>
        </div>
      </div>
    </div>

    <div class="modal " id="VariableModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title tr" id="myModalLabel">Select Variable</h4>
          </div>
          <div class="modal-body">
            <select class="form-control" id="VariableName" placeholder="Variable Name">
            </select>
            <span id="NoVariable" class="tr">No variables found.</span>

          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-primary varok standartbutton tr" data-dismiss="modal">Ok</button>
            <button type="button" class="btn btn-default standartbutton tr" data-dismiss="modal">Cancel</button>
          </div>
        </div>
      </div>
    </div>

    <div class="modal " id="FunctionModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title tr" id="myModalLabel">Select Function</h4>
          </div>
          <div class="modal-body">
            <select class="form-control" id="FunctionNameInput" placeholder="Function Name">
            </select>
            <span id="NoFunctionFound" class="tr">No functions found.</span>

          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-primary funcok standartbutton tr" data-dismiss="modal">Ok</button>
            <button type="button" class="btn btn-default standartbutton tr" data-dismiss="modal">Cancel</button>
          </div>
        </div>
      </div>
    </div>

    

  </div>

  <!-- ========= -->
  <!-- TEMPLATES -->
  <!-- ========= -->

  <script type="text/template" id="expressioneditor">
    

    <div id="expressioneditor-list"></div>
    <div id="expressioneditor-constructor">
      
      <div id="expressioneditor-overlay">
        <div class="expressioneditor-overlay-title"><h2><span class="tr">Enter Value</span>:</h2></div>
        <div class="expressioneditor-overlay-data"><%= _.template($('#input_constructor').html())({id:"ExpressionValue", description:tr(""), default_selector: "string",disable_editor:true,min_number:-999999}) %></div>
        <div class="expressioneditor-overlay-buttons">
          <a href="#" class="btn btn-success btn-sm expressioneditor-button-accept" id="expressioneditor-valueok" ><span class="tr">OK</span></a><a href="#" id="expressioneditor-valuecancel" class="btn btn-danger btn-sm expressioneditor-button-accept" ><span class="tr">CANCEL</span></span></a>
        </div>
      </div>

      <div id="expressioneditor-overlay-confirm">
        <div class="expressioneditor-overlay-title"><h2><span class="tr">Confirm Changes</span>:</span></h2></div>
        <div class="expressioneditor-overlay-olddata"><span class="tr">Replace old value</span> <span id="expressioneditor-old-value"></span> <span class="tr">with new one</span>:</div>
        <div class="expressioneditor-overlay-data"><%= _.template($('#input_constructor').html())({id:"ExpressionValueConfirm", description:tr(""), default_selector: "expression",disable_editor:true,disable_int:true,disable_string:true}) %></div>
        <div class="expressioneditor-overlay-buttons">
          <a href="#" class="btn btn-success btn-sm expressioneditor-button-accept" id="expressioneditor-confirmok" ><span class="tr">OK</a><a href="#" id="expressioneditor-confirmcancel" class="btn btn-danger btn-sm expressioneditor-button-accept" ><span class="tr">CANCEL</span></a>
        </div>
      </div>

      <div class="expressioneditor-container">
        
        <button type="button" class="btn btn-info expressioneditor-add-string btn-sm"><span class="tr">STRING</span> +</button>
        <button type="button" class="btn btn-info expressioneditor-add-int btn-sm"><span class="tr">INT</span> +</button>
        <button type="button" class="btn btn-info expressioneditor-add-expression btn-sm"><span class="tr">EXPRESSION</span> +</button>
        
        <span id="expressioneditor-expression"></span>
        <div class="expressioneditor-bottom-titlebar">
           <a href="#" class="btn btn-success btn-sm expressioneditor-button-accept" id="expressioneditor-ok" ><span class="tr">ACCEPT</span> &gt;</a>   <a href="#" id="expressioneditor-cancel" class="btn btn-danger btn-sm expressioneditor-button-accept" ><span class="tr">CANCEL</tr></a>
        </div>
        <div class="expressioneditor-navigator">
        </div>
      </div>
    </div>
  </script>

  <script type="text/template" id="expressioneditor-list-item">
    <div><a href="#" class="expressioneditor-tool" data-name="<%= name %>"><%= name_translate %></a> : <%= description %></div>
  </script>


  <script type="text/template" id="main">
    <div class="container-fluid mainscreen" >
      <div>
          <% var first = true; %>
          <% _.each(data, function(task) { %>
              <% if(typeof(task.type) != "undefined" && task.type == "group") { %>
                <div class="description"> <%= task.description %>: </div>
                <% first = true; %>
              <% } else { %>
                <div class="tool <%= (first)? "toolfirst" : "" %>" >
                  <a class="toolbutton" href="#!/<%= task.ref %>" data-toggle="tooltip" data-placement="right" title="<%= task.description %>" data-name="<%= task.name %>"><i class="fa fa-cog"></i> <%= task.name %> </a>
                </div>
                <% first = false; %>
              <% } %>
          <% }); %>
      </div>
    </div>
  </script>

  <script type="text/template" id="back">
    <div class="container-fluid back" >
      <div class="col-xs-12">
        <a class="btn btn-success standartbutton tr" id="ok">Ok</a> <a class="btn btn-danger standartbutton tr" href="#!/" id="backtomain">Cancel</a>
        <span id="validation" class="text-muted"><%= _GobalModel.GetPageInfo() || name %></span>
        <% if(visible){ %>
          <div class="btn-group" role="group" id="executetype">
            <button type="button" class="btn <%= (action == "execute") ? "btn-info":"btn-default" %> tr" data-action="execute">Only Execute</button>
            <button type="button" class="btn <%= (action == "add") ? "btn-info":"btn-default" %> tr" data-action="add">Only Add</button>
            <button type="button" class="btn <%= (action == "executeandadd") ? "btn-info":"btn-default" %> tr" data-action="executeandadd">Execute And Add</button>
          </div>
        <% } %>
      </div>
    </div>
  </script>

  <script type="text/template" id="variable_constructor">
    <span data-preserve="true" data-preserve-type="var" data-preserve-id="<%= id %>">
      <div class="col-xs-12">
        <form class="form-horizontal">
          <div class="form-group">
            <div class="col-xs-5">
              <input class="form-control variable-input" type="text" id="<%= id %>" placeholder="<%= description %>" value="<%= default_variable %>" data-variable-constructor="true" <%= (typeof(append_mode) != "undefined") ? "data-append-array=\"true\"" : "" %> >
            </div>
            <button type="button" class="btn btn-default var" data-toggle="modal" data-target="#VariableModal" data-result-target="#<%= id %>" ><i class="fa fa-at"></i></button>
            <label class="col-xs-6 control-label" for="<%= id %>"><%= description %></label>
          </div>
        </form>
      </div>
    </span>
  </script>

  <script type="text/template" id="resource_constructor">
    <span data-preserve="true" data-preserve-type="var" data-preserve-id="<%= id %>">
      <div class="col-xs-12">
        <form class="form-horizontal">
          <div class="form-group">
            <div class="col-xs-5">
              <input class="form-control resource-input" type="text" id="<%= id %>" placeholder="<%= description %>" value="" data-resource-constructor="true" />
            </div>
            <button type="button" class="btn btn-default var" data-toggle="modal" data-target="#RecourseModal" data-result-target="#<%= id %>" ><i class="fa fa-database"></i></button>
            <label class="col-xs-6 control-label" for="<%= id %>"><%= description %></label>
          </div>
        </form>
      </div>
    </span>
  </script>

  <script type="text/template" id="path">
    <div class="path" >

      <div class="input-group pull-right">
        <input type="text" class="form-control" aria-label="..." id="selector-input">
        <div class="input-group-btn">
          <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span id="selector"><%= selector["current"] %></span> <span class="caret"></span></button>
          <ul class="dropdown-menu dropdown-menu-right">
            <li><a id="css" class="tr">css</a></li>
            <li><a id="match" class="tr">match</a></li>
            <li><a id="at" class="tr">at</a></li>
            <li><a id="none" class="tr">none</a></li>
          </ul>
        </div>
        <button type="button" class="btn btn-default res" data-toggle="modal" data-target="#RecourseModal" data-result-target="#selector-input" ><i class="fa fa-database"></i></button>
        <button type="button" class="btn btn-default varminim" data-toggle="modal" data-target="#VariableModal" data-result-target="#selector-input" ><i class="fa fa-at"></i></button>

      </div>
    </div>
  </script>

  <script type="text/template" id="input_constructor">
    <span data-preserve="true" data-preserve-type="constr" data-preserve-id="<%= id %>">
      <% if(typeof(dont_use_top) == "undefined"){ %>
        <div class="col-xs-12">
        <form class="form-horizontal">
          <div class="form-group">
          <% } %>
            <div class="col-xs-<%= (typeof(size) == 'undefined') ? "6" : size.toString() %>">
              <% if(typeof(use_textarea) == "undefined"){ %>
               <div class="input-group">
              <% } %>
                <<%= (typeof(use_textarea) == "undefined") ? "input type=\"text\"" : "textarea style=\"height:146px\"" %>  class="form-control input_selector_string" id="<%= id %>" <%= (default_selector == "int") ? "style=\"display:none\"" : "" %> placeholder="<%= description %>" value="<%= (typeof(value_string) != "undefined") ? value_string : "" %>" />
                <input class="form-control input_selector_number" type="number" id="<%= id %>_number" <%= (default_selector != "int") ? "style=\"display:none\"" : "" %> placeholder="<%= description %>" value="<%= (typeof(value_number) != "undefined") ? value_number : 1%>" step="<%= (typeof(step_number) != "undefined") ? step_number : 1%>" min="<%= (typeof(min_number) != "undefined") ? min_number : 0%>" max="<%= (typeof(max_number) != "undefined") ? max_number : 10000%>" />
                <div class="input-group-btn" <%= (typeof(disable_type_chooser) != "undefined") ? "style=\"display:none\"" : "" %>>
                  <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="selector" data-selector-id="<%= id %>"><%= default_selector %></span> <span class="caret"></span></button>
                  <ul class="dropdown-menu dropdown-menu-right">
                    <% if(typeof(disable_string) == "undefined") { %>
                      <li><a class="string" class="tr">string</a></li>
                    <% } %>

                    <% if(typeof(disable_int) == "undefined") { %>
                      <li><a class="int">int</a></li>
                    <% } %>

                    <% if(typeof(disable_expression) == "undefined") { %>
                      <li><a class="expression">expression</a></li>
                    <% } %>
                  </ul>
                </div>
              <% if(typeof(use_textarea) == "undefined"){ %>
                </div>
              <% } %>
            </div>
            <% if(typeof(disable_editor) == "undefined") { %>
              <button type="button" class="btn btn-default edit" data-toggle="modal" data-result-target="#<%= id %>" ><i class="fa fa-circle" style="color:darkred"></i></button>
            <% } %>

            <% if(typeof(disable_resource) == "undefined") { %>
              <button type="button" class="btn btn-default res" data-toggle="modal" data-target="#RecourseModal" data-result-target="#<%= id %>" ><i class="fa fa-database"></i></button>
            <% } %>
            <% if(typeof(disable_variable) == "undefined") { %>
              <button type="button" class="btn btn-default var" data-toggle="modal" data-target="#VariableModal" data-result-target="#<%= id %>" ><i class="fa fa-at"></i></button>
            <% } %>

            <% if(typeof(variants) != "undefined") { %>
              <% for(var i = 0;i<variants.length;i++) { %>
                <button type="button" class="btn btn-default variant" data-variant="<%= variants[i] %>" data-result="<%= id %>" ><%= variants[i] %></button>
              <% } %>
            <% } %>
            <% if(typeof(disable_label) == "undefined"){ %>
              <label class="col-xs-<%= (typeof(size_label) == 'undefined') ? "4" : size_label.toString() %> control-label" for="<%= id %>"><%= description %></label>
            <% } %>        
            <% if(typeof(dont_use_top) == "undefined"){ %>
          </div>
        </form>
      </div>
      <% } %>
    </span>

  </script>

  <script type="text/template" id="special_buttons">
    <div class="col-xs-12">
        <button type="button" class="btn btn-default specialletter btn-xs">CONTROL</button>
        <button type="button" class="btn btn-default specialletter btn-xs">MENU</button>
        <button type="button" class="btn btn-default specialletter btn-xs">SHIFT</button>
        <button type="button" class="btn btn-default specialletter btn-xs">CANCEL</button>
        <button type="button" class="btn btn-default specialletter btn-xs">BACK</button>
        <button type="button" class="btn btn-default specialletter btn-xs">TAB</button>
        <button type="button" class="btn btn-default specialletter btn-xs">CLEAR</button>
        <button type="button" class="btn btn-default specialletter btn-xs">RETURN</button>
        <button type="button" class="btn btn-default specialletter btn-xs">CAPITAL</button>
        <button type="button" class="btn btn-default specialletter btn-xs">ESCAPE</button>
        <button type="button" class="btn btn-default specialletter btn-xs">PRIOR</button>
        <button type="button" class="btn btn-default specialletter btn-xs">NEXT</button>
        <button type="button" class="btn btn-default specialletter btn-xs">END</button>
        <button type="button" class="btn btn-default specialletter btn-xs">HOME</button>
        <button type="button" class="btn btn-default specialletter btn-xs">LEFT</button>
        <button type="button" class="btn btn-default specialletter btn-xs">UP</button>
        <button type="button" class="btn btn-default specialletter btn-xs">RIGHT</button>
        <button type="button" class="btn btn-default specialletter btn-xs">DOWN</button>
        <button type="button" class="btn btn-default specialletter btn-xs">SELECT</button>
        <button type="button" class="btn btn-default specialletter btn-xs">PRINT</button>
        <button type="button" class="btn btn-default specialletter btn-xs">EXECUTE</button>
        <button type="button" class="btn btn-default specialletter btn-xs">SNAPSHOT</button>
        <button type="button" class="btn btn-default specialletter btn-xs">INSERT</button>
        <button type="button" class="btn btn-default specialletter btn-xs">DELETE</button>
      </div>
  </script>


  <script type="text/template" id="load">
    <div class="container-fluid load">
      <%= _.template($('#input_constructor').html())({id:"LoadUrl", description:tr("Url to load"), default_selector: "string", disable_int:true}) %>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>


  <script type="text/template" id="break">
    <div class="container-fluid break">
      <%= _.template($('#input_constructor').html())({id:"BreakDepth", description:tr("Break depth"), default_selector: "int"}) %>
    </div>
    <div class="tooltipinternal tr">Break depth. If blank will break current loop, if integer will break with desired depth, if string will break until desired function.</div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:false}) %>
  </script>

   <script type="text/template" id="continue">
    <div class="container-fluid continue">
      <div class="tooltipinternal tr">Start next loop iteration.</div>
      <%= _.template($('#back').html())({action:"executeandadd", visible:false}) %>
    </div>
  </script>

  <script type="text/template" id="success">
    <div class="container-fluid success">
      <div class="tooltipinternal tr">Finish script with success result.</div>
      <%= _.template($('#back').html())({action:"executeandadd", visible:false}) %>
    </div>
  </script>

  <script type="text/template" id="fail">
    <div class="container-fluid fail">
     <%= _.template($('#input_constructor').html())({id:"FailMessage", description:tr("Fail Message"), default_selector: "string", disable_int:true}) %>
    </div>
     <div class="tooltipinternal tr">Finish script with fail result.</div>
     <%= _.template($('#back').html())({action:"executeandadd", visible:false}) %>

  </script>

  <script type="text/template" id="custom">
    <div class="container-fluid custom">
      <%= _.template($('#input_constructor').html())({id:"Code", description:tr("Custom Code"), default_selector: "expression", disable_int:true, disable_editor:true, disable_string:true, use_textarea:true, size: 8, disable_type_chooser:true}) %>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>


  <script type="text/template" id="waitload">
    <div class="container-fluid load">
      <%= _.template($('#input_constructor').html())({id:"Wait", description:tr("Wait until browser will load url"), default_selector: "string", disable_int:true}) %>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>

  <script type="text/template" id="waiturl">
    <div class="container-fluid load">
      <%= _.template($('#input_constructor').html())({id:"Wait", description:tr("Wait address bar will contain url"), default_selector: "string", disable_int:true}) %>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>

  <script type="text/template" id="waitcontent">
    <div class="container-fluid load">
      <%= _.template($('#input_constructor').html())({id:"Wait", description:tr("Wait until specific text will be present on page"), default_selector: "string", disable_int:true}) %>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>

  <script type="text/template" id="waitcss">
    <div class="container-fluid load">
      <%= _.template($('#input_constructor').html())({id:"Wait", description:tr("Wait until specific css selector will return non empty result"), default_selector: "string", disable_int:true}) %>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>



  <script type="text/template" id="executefunction">
    <div class="container-fluid executefunction">
      <div class="col-xs-12">
        <form class="form-horizontal">
          <div class="form-group">
            <div class="col-xs-5">
              <span data-preserve="true" data-preserve-type="text" data-preserve-id="FunctionName">
                <input class="form-control function-input" type="text" id="FunctionName" placeholder="Function name">
              </span>
            </div>
            <button type="button" class="btn btn-default func" data-toggle="modal" data-target="#FunctionModal" data-result-target="#FunctionName" ><i class="fa fa-dot-circle-o"></i></button>
            <label class="col-xs-6 control-label tr" for="FunctionName">Function name</label>
          </div>
        </form>
      </div>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:false}) %>
  </script>


  <script type="text/template" id="setheader">
    <div class="container-fluid setheader">
      <%= _.template($('#input_constructor').html())({id:"Name", description:tr("Header Name"), default_selector: "string", disable_int:true, value_string: "User-Agent", variants: ["User-Agent","Accept-Language"], size: 3}) %>
      <%= _.template($('#input_constructor').html())({id:"Value", description:tr("Header Value"), default_selector: "string", disable_int:true, value_string: "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:44.0) Gecko/20100101 Firefox/44.0"}) %>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>

  <script type="text/template" id="solvecaptcha">
    <div class="container-fluid solvecaptcha">
      <%= _.template($('#input_constructor').html())({id:"Value", description:tr("Captcha picture data encoded in base64"), default_selector: "expression", disable_int:true, disable_string:true}) %>
      <%= _.template($('#input_constructor').html())({id:"Method", description:tr("Solve Method"), default_selector: "string", disable_int:true, value_string: "manual", variants: ["manual","antigate","rucaptcha","2captcha","dbc"], size: 3}) %>
      <%= _.template($('#input_constructor').html())({id:"Antigate", description:tr("Antigate/Rucaptcha/2captcha Key. Can be blank"), default_selector: "string", disable_int:true}) %>
      <%= _.template($('#input_constructor').html())({id:"Dbc", description:tr("DBC Login:Password. Can be blank"), default_selector: "string", disable_int:true}) %>
      <%= _.template($('#variable_constructor').html())({id:"Save", description:tr("Variable To Save Result"), default_variable: "CAPTCHA_RESULT"}) %>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>
  
  <script type="text/template" id="javascript">
      <div class="container-fluid javascript">
        <%= _.template($('#variable_constructor').html())({id:"Save", description:tr("Variable To Save"), default_variable: "SAVED_SCRIPT_RESULT"}) %>
        <%= _.template($('#input_constructor').html())({id:"Value", description:tr("Script Text"), default_selector: "string", disable_int:true}) %>
      </div>
      <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>

  <script type="text/template" id="parseline">
    <div class="container-fluid parseline">
      <%= _.template($('#input_constructor').html())({id:"Value", description:tr("Line"), default_selector: "string", disable_int:true}) %>
      <%= _.template($('#variable_constructor').html())({id:"VariablesList", description:tr("Variables To Save Result"), default_variable: "USERNAME,PASSWORD", append_mode:true}) %>
      <div class="tooltipinternal tr">Parse line which contains list of varibales. Example, parse line <i>email@gmail.com:mypass1</i> to variables USERNAME and PASSWORD.</div>
      <div class="tooltipinternal tr">Put variables in following format to Variables List field: USERNAME,PASSWORD</div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
    
  </script>

  <script type="text/template" id="reset">
      <div class="container-fluid reset">
        <div class="tooltipinternal tr">Clear all browser data.</div>
      </div>
      <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>

  <script type="text/template" id="openfile">
    <div class="container-fluid openfile">
      <%= _.template($('#input_constructor').html())({id:"Value", description:tr("File path to set as result of open file dialog"), default_selector: "string", disable_int:true}) %>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>

  <script type="text/template" id="promptresult">
    <div class="container-fluid promptresult">
      <%= _.template($('#input_constructor').html())({id:"Value", description:tr("Prompt user input result"), default_selector: "string", disable_int:true}) %>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>

  <script type="text/template" id="httpauth">
    <div class="container-fluid httpauth">
      <%= _.template($('#input_constructor').html())({id:"Login", description:tr("Http auth login"), default_selector: "string", disable_int:true}) %>
      <%= _.template($('#input_constructor').html())({id:"Password", description:tr("Http auth password"), default_selector: "string", disable_int:true}) %>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>

  <script type="text/template" id="getcookiesforurl">
      <div class="container-fluid getcookiesforurl">
        <%= _.template($('#input_constructor').html())({id:"Value", description:tr("Url"), default_selector: "string", disable_int:true}) %>
        <%= _.template($('#variable_constructor').html())({id:"Save", description:tr("Variable To Save"), default_variable: "COOKIES_FOR_URL"}) %>
      </div>
      <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>

  <script type="text/template" id="savecookies">
    <div class="container-fluid savecookies">
          <%= _.template($('#variable_constructor').html())({id:"Save", description:tr("Variable To Save"), default_variable: "SAVED_COOKIES"}) %>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>

  <script type="text/template" id="restorecookies">
    <div class="container-fluid restorecookies">
      <%= _.template($('#input_constructor').html())({id:"Value", description:tr("Cookies"), default_selector: "string", disable_int:true}) %>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>

  <script type="text/template" id="scroll">
    <div class="container-fluid scroll">
      <%= _.template($('#input_constructor').html())({id:"X", description:tr("Scroll x position"), default_selector: "int", disable_string:true}) %>
      <%= _.template($('#input_constructor').html())({id:"Y", description:tr("Scroll y position"), default_selector: "int", disable_string:true}) %>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>

  <script type="text/template" id="html">
      <div class="container-fluid html">
        <%= _.template($('#variable_constructor').html())({id:"Save", description:tr("Variable To Save"), default_variable: "SAVED_PAGE_HTML"}) %>
      </div>
      <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>

  <script type="text/template" id="renderscreen">
    <div class="container-fluid renderscreen">
    <div class="col-xs-12">
      <form class="form-horizontal">
        <div class="form-group">
          <%= _.template($('#input_constructor').html())({id:"X", description:"X", default_selector: "int", disable_string:true, value_number:0, dont_use_top: true, size:2, size_label:2 }) %>
          <%= _.template($('#input_constructor').html())({id:"Y", description:"Y", default_selector: "int", disable_string:true, value_number:0, dont_use_top: true, size:2, size_label:2 }) %>
        </div>
      </form>
    </div>
    <div class="col-xs-12">
      <form class="form-horizontal">
        <div class="form-group">
          <%= _.template($('#input_constructor').html())({id:"Width", description:tr("Width"), default_selector: "int", disable_string:true, value_number:100, dont_use_top: true, size:2, size_label:2}) %>
          <%= _.template($('#input_constructor').html())({id:"Height", description:tr("Height"), default_selector: "int", disable_string:true, value_number:100, dont_use_top: true, size:2, size_label:2}) %>
        </div>
      </form>
    </div>
    <%= _.template($('#variable_constructor').html())({id:"Save", description:tr("Variable to save as base64 png"), default_variable: "RENDER_RESULT"}) %>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>

<script type="text/template" id="cachemaskallow">
    <div class="container-fluid cachemaskallow">
      <%= _.template($('#input_constructor').html())({id:"Value", description:tr("Match"), default_selector: "string", disable_int:true}) %>
      <div class="tooltipinternal tr">Add page content to cache if url is matching. For example *.json - caches all json</div>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>
  
  <script type="text/template" id="cachemaskdeny">
    <div class="container-fluid cachemaskdeny">
      <%= _.template($('#input_constructor').html())({id:"Value", description:tr("Match"), default_selector: "string", disable_int:true}) %>
      <div class="tooltipinternal tr">Do not add page content to cache if url is matching.</div>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>

  <script type="text/template" id="cachemaskclear">
    <div class="container-fluid cachemaskclear">
      <div class="tooltipinternal tr">Clear all cache masks.</div>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>

  <script type="text/template" id="requestmaskallow">
    <div class="container-fluid requestmaskallow">
      <%= _.template($('#input_constructor').html())({id:"Value", description:tr("Match"), default_selector: "string", disable_int:true}) %>
      <div class="tooltipinternal tr">Allow load url if url is matching. By default every url is loaded</div>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>

  <script type="text/template" id="requestmaskdeny">
    <div class="container-fluid requestmaskdeny">
      <%= _.template($('#input_constructor').html())({id:"Value", description:tr("Match"), default_selector: "string", disable_int:true}) %>
      <div class="tooltipinternal tr">Deny load url if url is matching. For example *.png disables loading png images.</div>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>

  <script type="text/template" id="requestmaskclear">
    <div class="container-fluid requestmaskclear">
      <div class="tooltipinternal tr">Clear all requests masks.</div>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>

  <script type="text/template" id="cleardata">
    <div class="container-fluid cleardata">
      <div class="tooltipinternal tr">Clear all cache masks.</div>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>

  <script type="text/template" id="clearmasks">
    <div class="container-fluid clearmasks">
      <div class="tooltipinternal tr">Clear info about all loaded urls.</div>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>

  <script type="text/template" id="getstatus">
    <div class="container-fluid getstatus">
      <%= _.template($('#input_constructor').html())({id:"Value", description:tr("Match"), default_selector: "string", disable_int:true}) %>
      <%= _.template($('#variable_constructor').html())({id:"Save", description:tr("Variable To Save"), default_variable: "SAVED_STATUS"}) %>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>

  <script type="text/template" id="isloaded">
    <div class="container-fluid isloaded">
      <%= _.template($('#input_constructor').html())({id:"Value", description:tr("Match"), default_selector: "string", disable_int:true}) %>
      <%= _.template($('#variable_constructor').html())({id:"Save", description:tr("Variable To Save"), default_variable: "SAVED_IS_LOADED"}) %>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>
  
  <script type="text/template" id="getfromcache">
    <div class="container-fluid getfromcache">
      <%= _.template($('#input_constructor').html())({id:"Value", description:tr("Match"), default_selector: "string", disable_int:true}) %>
      <%= _.template($('#variable_constructor').html())({id:"Save", description:tr("Variable To Save"), default_variable: "SAVED_CACHE"}) %>
       <span data-preserve="true" data-preserve-type="check" data-preserve-id="Check">
         <input type="checkbox" id="Check"/> <label for="Check" class="tr">Encode in base64</label>
       </span>

      <div class="tooltipinternal tr">After execution variale will hold cached page content which matching url.</div>

    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>
  
  <script type="text/template" id="result">
    <div class="container-fluid result">
       <%= _.template($('#input_constructor').html())({id:"Value", description:tr("Result Data"), default_selector: "string", disable_int:true}) %>
       <div class="col-xs-12">
        <form class="form-horizontal">
          <div class="form-group">
            <div class="col-xs-2">
              <div class="input-group">
                <span data-preserve="true" data-preserve-type="select" data-preserve-id="Select">
                  <select class="form-control input-sm" id="Select" placeholder="Result">
                      <option value="1" selected="selected">1</option>
                      <option value="2">2</option>
                      <option value="3">3</option>
                      <option value="4">4</option>
                      <option value="5">5</option>
                      <option value="6">6</option>
                      <option value="7">7</option>
                      <option value="8">8</option>
                      <option value="9">9</option>
                  </select>
                </span>
              </div>
            </div>
            <label class="control-label text-right tr" style="padding-top:5px !important;">Result Placeholder</label>
          </div>
        </form>
      </div>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>

  <script type="text/template" id="timeout">
    <div class="container-fluid result">
       <%= _.template($('#input_constructor').html())({id:"Value", description:tr("Timeout in milliseconds"), default_selector: "int", disable_string:true, value_number: 60000, min_number: 1000}) %>
       <div class="col-xs-12">
        <form class="form-horizontal">
          <div class="form-group">
            <div class="col-xs-2">
              <div class="input-group">
                <span data-preserve="true" data-preserve-type="select" data-preserve-id="Type">
                  <select class="form-control input-sm" id="Type" placeholder="Result">
                      <option value="general" selected="selected">General</option>
                      <option value="solver">Solver</option>
                  </select>
                </span>
              </div>
            </div>
            <label class="control-label text-right tr" style="padding-top:5px !important;">Timeout Type</label>
          </div>
        </form>
      </div>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>

  <script type="text/template" id="base64">
    <div class="container-fluid base64">
      <%= _.template($('#input_constructor').html())({id:"Value", description:tr("Data"), default_selector: "string", disable_int:true}) %>
      <%= _.template($('#variable_constructor').html())({id:"Save", description:tr("Variable To Save"), default_variable: "BASE64_ENCODING_RESULT"}) %>
      <div class="col-xs-12">
        <form class="form-horizontal">
          <div class="form-group">
            <div class="col-xs-2">
              <div class="input-group">
              <span data-preserve="true" data-preserve-type="select" data-preserve-id="Select">
                <select class="form-control input-sm" id="Select" placeholder="Is Encode">
                    <option value="encode" selected="selected" >encode</option>
                    <option value="decode" >decode</option>
                </select>
              </span>
              </div>
            </div>
            <label class="control-label text-right tr" style="padding-top:5px !important;">Encode or decode</label>
          </div>
        </form>
      </div>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>

<script type="text/template" id="globalset">
    <div class="container-fluid globalset">
      <%= _.template($('#input_constructor').html())({id:"Group", description:tr("Group"), default_selector: "string", disable_int:true}) %>
      <%= _.template($('#input_constructor').html())({id:"Name", description:tr("Name"), default_selector: "string", disable_int:true}) %>
      <%= _.template($('#input_constructor').html())({id:"Value", description:tr("Value"), default_selector: "string"}) %>
      <div class="tooltipinternal tr">Global variables are availabe during whole script run.</div>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>

  <script type="text/template" id="globalget">
    <div class="container-fluid globalget">
      <%= _.template($('#input_constructor').html())({id:"Group", description:tr("Group"), default_selector: "string", disable_int:true}) %>
      <%= _.template($('#input_constructor').html())({id:"Name", description:tr("Name"), default_selector: "string", disable_int:true}) %>
      <%= _.template($('#variable_constructor').html())({id:"Save", description:tr("Variable To Save"), default_variable: "GLOBAL_VARIABLE_RESULT"}) %>
      <div class="tooltipinternal">Global variables are availabe during whole script run.</div>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>

  <script type="text/template" id="emailsettings">
    <div class="container-fluid emailsettings">
      <%= _.template($('#input_constructor').html())({id:"Host", description:tr("Imap Server Host"), default_selector: "string", disable_int:true}) %>
      <%= _.template($('#input_constructor').html())({id:"Port", description:tr("Port"), default_selector: "int", disable_string:true, value_number: 993}) %>
      <%= _.template($('#input_constructor').html())({id:"Username", description:tr("Username. Can be blank"), default_selector: "string", disable_int:true}) %>
      <%= _.template($('#input_constructor').html())({id:"Password", description:tr("Password. Can be blank"), default_selector: "string", disable_int:true}) %>
      <div class="col-xs-12">
        <form class="form-horizontal">
          <div class="form-group">
            <div class="col-xs-2">
              <div class="input-group">
              <span data-preserve="true" data-preserve-type="select" data-preserve-id="Select">
                <select class="form-control input-sm" id="Select" placeholder="Encryption">
                    <option value="ssl" selected="selected">ssl</option>
                    <option value="none">none</option>
                </select>
              </span>
              </div>
            </div>
            <label class="control-label text-right tr" style="padding-top:5px !important;">Encryption</label>
          </div>
        </form>
      </div>
      <%= _.template($('#input_constructor').html())({id:"Inbox", description:tr("Inbox name"), default_selector: "string", disable_int:true, value_string:"INBOX"}) %>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>

  <script type="text/template" id="emailproxy">
    <div class="container-fluid" >
      <%= _.template($('#input_constructor').html())({id:"ProxyText", description:tr("Proxy String"), default_selector: "string", disable_int:true}) %>

      <div class="col-xs-12">
        <form class="form-horizontal">
          <div class="form-group">
            <div class="col-xs-2">
              <div class="input-group">
              <span data-preserve="true" data-preserve-type="select" data-preserve-id="ProxyType">
                <select class="form-control input-sm" id="ProxyType" placeholder="Function Name">
                    <option value="auto" class="tr">auto</option>
                    <option value="http" class="tr" selected>http</option>
                    <option value="socks5" class="tr">socks5</option>
                </select>
              </span>
              </div>
            </div>
            <label class="control-label text-right tr" style="padding-top:5px !important;">Proxy Type</label>
          </div>
        </form>
      </div>
      <%= _.template($('#input_constructor').html())({id:"ProxyLogin", description:tr("Proxy Login. Can be blank."), default_selector: "string", disable_int:true}) %>
      <%= _.template($('#input_constructor').html())({id:"ProxyPassword", description:tr("Proxy password. Can be blank."), default_selector: "string", disable_int:true}) %>
    </div>
    <%= _.template($('#back').html())({action:"add", visible:true}) %>
  </script>

  <script type="text/template" id="emaillength">
    <div class="container-fluid emaillength">
      <%= _.template($('#variable_constructor').html())({id:"Save", description:tr("Variable To Save"), default_variable: "SAVED_MAILBOX_LENGTH"}) %>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>

  <script type="text/template" id="emailsearchfirst">
    <div class="container-fluid emailsearchfirst">
      <%= _.template($('#input_constructor').html())({id:"Sender", description:tr("Sender Query"), default_selector: "string", disable_int:true}) %>
      <%= _.template($('#input_constructor').html())({id:"Subject", description:tr("Subject Query"), default_selector: "string", disable_int:true}) %>
      <%= _.template($('#input_constructor').html())({id:"Body", description:tr("Body Query"), default_selector: "string", disable_int:true}) %>
      <%= _.template($('#variable_constructor').html())({id:"Save", description:tr("Variable To Save"), default_variable: "MAIBOX_SEARCH_RESULT"}) %>
      <%= _.template($('#variable_constructor').html())({id:"VariablesList", description:tr("Variables To Save Links"), default_variable: "LINK1,LINK2,LINK3", append_mode:true}) %>
      <div class="tooltipinternal tr">Parse email and get link list. Put variables in following format to Variables To Save Links: LINK1,LINK2,LINK3</div>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>
<script type="text/template" id="emailsearchall">
    <div class="container-fluid emailsearchall">
      <%= _.template($('#input_constructor').html())({id:"Sender", description:tr("Sender Query"), default_selector: "string", disable_int:true}) %>
      <%= _.template($('#input_constructor').html())({id:"Subject", description:tr("Subject Query"), default_selector: "string", disable_int:true}) %>
      <%= _.template($('#input_constructor').html())({id:"Body", description:tr("Body Query"), default_selector: "string", disable_int:true}) %>
      <%= _.template($('#variable_constructor').html())({id:"Save", description:tr("Variable To Save"), default_variable: "MAIBOX_SEARCH_RESULT"}) %>
   </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>

  <script type="text/template" id="emailpull">
    <div class="container-fluid emailpull">
      <%= _.template($('#input_constructor').html())({id:"Value", description:tr("Message Id"), default_selector: "string", disable_int:true}) %>
      <div class="tooltipinternal tr">Use action 'Search First', if you want to get only one message.</div>

      <%= _.template($('#variable_constructor').html())({id:"Save", description:tr("Variable To Save"), default_variable: "MAIL_BODY"}) %>
      <%= _.template($('#variable_constructor').html())({id:"VariablesList", description:tr("Variables To Save Links"), default_variable: "LINK1,LINK2,LINK3", append_mode:true}) %>
      <div class="tooltipinternal tr">Parse email and get link list. Put variables in following format to Variables To Save Links: LINK1,LINK2,LINK3</div>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>

<script type="text/template" id="httpclientproxy">
    <div class="container-fluid" >
      <%= _.template($('#input_constructor').html())({id:"ProxyText", description:tr("Proxy String"), default_selector: "string", disable_int:true}) %>

      <div class="col-xs-12">
        <form class="form-horizontal">
          <div class="form-group">
            <div class="col-xs-2">
              <div class="input-group">
                <span data-preserve="true" data-preserve-type="select" data-preserve-id="ProxyType">
                  <select class="form-control input-sm" id="ProxyType" placeholder="Function Name">
                      <option value="auto" class="tr">auto</option>
                      <option value="http" selected class="tr">http</option>
                      <option value="socks5" class="tr">socks5</option>
                  </select>
                </span>
              </div>
            </div>
            <label class="control-label text-right tr" style="padding-top:5px !important;">Proxy Type</label>
          </div>
        </form>
      </div>
      <%= _.template($('#input_constructor').html())({id:"ProxyLogin", description:tr("Proxy Login. Can be blank."), default_selector: "string", disable_int:true}) %>
      <%= _.template($('#input_constructor').html())({id:"ProxyPassword", description:tr("Proxy password. Can be blank."), default_selector: "string", disable_int:true}) %>
    </div>
    <%= _.template($('#back').html())({action:"add", visible:true}) %>
  </script>
<script type="text/template" id="httpclientreset">
    <div class="container-fluid httpclientreset">
      <div class="tooltipinternal tr">Clear all http client data.</div>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>
<script type="text/template" id="httpclientdownload">
    <div class="container-fluid httpclientdownload">
      <%= _.template($('#input_constructor').html())({id:"Value", description:tr("Url"), default_selector: "string", disable_int:true}) %>
      <%= _.template($('#input_constructor').html())({id:"File", description:tr("File Path"), default_selector: "string", disable_int:true}) %>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>
<script type="text/template" id="httpclientget">
    <div class="container-fluid httpclientget">
      <%= _.template($('#input_constructor').html())({id:"Value", description:tr("Url"), default_selector: "string", disable_int:true}) %>
      <span data-preserve="true" data-preserve-type="check" data-preserve-id="Check">
        <input type="checkbox" id="Check" checked="checked"/> <label for="Check" class="tr">Follow redirects</label>
      </span>

    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>
<script type="text/template" id="httpclientpost">
    <div class="container-fluid httpclientpost">
      <%= _.template($('#input_constructor').html())({id:"Value", description:tr("Url"), default_selector: "string", disable_int:true}) %>
      <%= _.template($('#input_constructor').html())({id:"PostData", description:tr("Post Data"), default_selector: "expression", disable_int:true, disable_string:true}) %>
      <div class="col-xs-12">
        <form class="form-horizontal">
          <div class="form-group">
            <%= _.template($('#input_constructor').html())({id:"PostName", description:tr("Name"), default_selector: "string", disable_int:true, dont_use_top: true, size:3, disable_label: true }) %>
            <%= _.template($('#input_constructor').html())({id:"PostValue", description:tr("Value"), default_selector: "string", disable_int:true, dont_use_top: true, size:3, disable_label: true }) %>
            <button type="button" class="btn btn-default addtopost" > + <span class="tr">Add</span></button>
          </div>
        </form>
      </div>
      <span data-preserve="true" data-preserve-type="check" data-preserve-id="Check">
        <input type="checkbox" id="Check" checked="checked"/> <label for="Check" class="tr">Follow redirects</label>
      </span>
      <span data-preserve="true" data-preserve-type="check" data-preserve-id="CheckSecond">
        <input type="checkbox" id="CheckSecond" style="margin-left:20px"/> <label for="CheckSecond" class="tr">Is Multipart</label>
      </span>

    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>
<script type="text/template" id="httpclienturl">
    <div class="container-fluid httpclienturl">
      <%= _.template($('#variable_constructor').html())({id:"Save", description:tr("Variable To Save"), default_variable: "SAVED_URL"}) %>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
</script>

  <script type="text/template" id="httpclientcontent">
    <div class="container-fluid httpclientcontent">
      <%= _.template($('#variable_constructor').html())({id:"Save", description:tr("Variable To Save"), default_variable: "SAVED_CONTENT"}) %>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>

  <script type="text/template" id="httpclientstatus">
    <div class="container-fluid httpclientstatus">
      <%= _.template($('#variable_constructor').html())({id:"Save", description:tr("Variable To Save"), default_variable: "SAVED_STATUS"}) %>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>

  <script type="text/template" id="httpclientgetheader">
    <div class="container-fluid httpclientgetheader">
      <%= _.template($('#input_constructor').html())({id:"Value", description:tr("Header Name"), default_selector: "string", disable_int:true}) %>
      <%= _.template($('#variable_constructor').html())({id:"Save", description:tr("Variable To Save"), default_variable: "SAVED_HEADER"}) %>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>

  <script type="text/template" id="httpclientsetheader">
    <div class="container-fluid httpclientsetheader">
      <%= _.template($('#input_constructor').html())({id:"Name", description:tr("Header Name"), default_selector: "string", disable_int:true, value_string: "User-Agent", variants: ["User-Agent","Accept-Language"], size: 3}) %>
      <%= _.template($('#input_constructor').html())({id:"Value", description:tr("Header Value"), default_selector: "string", disable_int:true, value_string: "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:44.0) Gecko/20100101 Firefox/44.0"}) %>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>

  <script type="text/template" id="httpclientclearheader">
    <div class="container-fluid httpclientclearheader">
      <div class="tooltipinternal tr">Clear all headers.</div>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>

  <script type="text/template" id="httpclientgetcookiesforurl">
    <div class="container-fluid httpclientgetcookiesforurl">
        <%= _.template($('#input_constructor').html())({id:"Value", description:tr("Url"), default_selector: "string", disable_int:true}) %>
        <%= _.template($('#variable_constructor').html())({id:"Save", description:tr("Variable To Save"), default_variable: "COOKIES_FOR_URL"}) %>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>

  <script type="text/template" id="httpclientsavecookies">
    <div class="container-fluid httpclientsavecookies">
      <%= _.template($('#variable_constructor').html())({id:"Save", description:tr("Variable To Save"), default_variable: "SAVED_COOKIES"}) %>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>

  <script type="text/template" id="httpclientrestorecookies">
    <div class="container-fluid httpclientrestorecookies">
      <%= _.template($('#input_constructor').html())({id:"Value", description:tr("Cookies"), default_selector: "string", disable_int:true}) %>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>

  <script type="text/template" id="httpclientfailonerror">
    <div class="container-fluid httpclientfailonerror">
      <%= _.template($('#input_constructor').html())({id:"SetFailed", description:tr("Set Fail On Error"), default_selector: "string", disable_int:true, value_string: "fail", variants: ["fail","continue"], size: 5}) %>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>

  <script type="text/template" id="httpclientiserror">
    <div class="container-fluid httpclientiserror">
       <%= _.template($('#variable_constructor').html())({id:"Save", description:tr("Variable To Save"), default_variable: "HTTP_CLIENT_WAS_ERROR"}) %>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>

  <script type="text/template" id="httpclientgeterrorstring">
    <div class="container-fluid httpclientgeterrorstring">
      <%= _.template($('#variable_constructor').html())({id:"Save", description:tr("Variable To Save"), default_variable: "HTTP_CLIENT_ERROR_STRING"}) %>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>

  <script type="text/template" id="httpclientxpathxml">
    <div class="container-fluid httpclientxpathxml">
      <%= _.template($('#input_constructor').html())({id:"Value", description:tr("Xpath Query"), default_selector: "string", disable_int:true}) %>
      <%= _.template($('#variable_constructor').html())({id:"Save", description:tr("Variable To Save"), default_variable: "XPATH_XML"}) %>
      <span data-preserve="true" data-preserve-type="check" data-preserve-id="Check">
        <input type="checkbox" id="Check" checked="checked"/> <label for="Check" class="tr">Fail on error</label>
      </span>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>
  
  <script type="text/template" id="httpclientxpathtext">
    <div class="container-fluid httpclientxpathtext">
      <%= _.template($('#input_constructor').html())({id:"Value", description:tr("Xpath Query"), default_selector: "string", disable_int:true}) %>
      <%= _.template($('#variable_constructor').html())({id:"Save", description:tr("Variable To Save"), default_variable: "XPATH_TEXT"}) %>
      <span data-preserve="true" data-preserve-type="check" data-preserve-id="Check">
        <input type="checkbox" id="Check" checked="checked"/> <label for="Check" class="tr">Fail on error</label>
      </span>


    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>
  
  <script type="text/template" id="httpclientxpathcount">
    <div class="container-fluid httpclientxpathcount">
      <%= _.template($('#input_constructor').html())({id:"Value", description:tr("Xpath Query"), default_selector: "string", disable_int:true}) %>
      <%= _.template($('#variable_constructor').html())({id:"Save", description:tr("Variable To Save"), default_variable: "XPATH_COUNT"}) %>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>
  
  <script type="text/template" id="httpclientxpathexists">
    <div class="container-fluid httpclientxpathexists">
      <%= _.template($('#input_constructor').html())({id:"Value", description:tr("Xpath Query"), default_selector: "string", disable_int:true}) %>
      <%= _.template($('#variable_constructor').html())({id:"Save", description:tr("Variable To Save"), default_variable: "XPATH_EXISTS"}) %>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>

  <script type="text/template" id="if">
    <div class="container-fluid if">
      <%= _.template($('#input_constructor').html())({id:"IfExpression", description:tr("If expression"), default_selector: "expression", disable_int:true, disable_string:true}) %>
      <span data-preserve="true" data-preserve-type="check" data-preserve-id="IfElse">
        <input type="checkbox" id="IfElse"/> <label for="IfElse" class="tr">Add else block</label>
      </span>

    </div>
    <%= _.template($('#back').html())({action:"add", visible:false}) %>
  </script>

  <script type="text/template" id="while">
    <div class="container-fluid while">
      <%= _.template($('#input_constructor').html())({id:"WhileExpression", description:tr("While expression"), default_selector: "expression", disable_int:true, disable_string:true}) %>
    </div>
    <%= _.template($('#back').html())({action:"add", visible:false}) %>
  </script>

  <script type="text/template" id="for">
    <div class="container-fluid for">
      <%= _.template($('#input_constructor').html())({id:"ForFrom", description:tr("For from value"), default_selector: "expression", disable_string:true}) %>
      <%= _.template($('#input_constructor').html())({id:"ForTo", description:tr("For to value"), default_selector: "expression", disable_string:true}) %>
    </div>
    <%= _.template($('#back').html())({action:"add", visible:false}) %>
  </script>

  <script type="text/template" id="foreach">
    <div class="container-fluid foreach">
      <%= _.template($('#input_constructor').html())({id:"ForArray", description:tr("Foreach Array"), default_selector: "expression", disable_string:true, disable_int:true}) %>
    </div>
    <%= _.template($('#back').html())({action:"add", visible:false}) %>
  </script>

  <script type="text/template" id="sleep">
    <div class="container-fluid sleep">
      <span id="sleeprandomspan" style="display:none">
        <%= _.template($('#input_constructor').html())({id:"sleepfrom", description:tr("Sleep from value in milliseconds"), default_selector: "int", disable_string:true, min_number: 100, value_number: 1000}) %>
        <%= _.template($('#input_constructor').html())({id:"sleepto", description:tr("Sleep to value in milliseconds"), default_selector: "int", disable_string:true, min_number: 100, value_number: 1000}) %>
      </span>
      <span id="sleepspan">
        <%= _.template($('#input_constructor').html())({id:"sleepfromto", description:tr("Sleep value in milliseconds"), default_selector: "int", disable_string:true, min_number: 100, value_number: 1000}) %>
      </span>
      <span data-preserve="true" data-preserve-type="check" data-preserve-id="sleeprandom">
        <input type="checkbox" class="groupselector" data-checked-group-id="sleeprandomspan" data-unchecked-group-id="sleepspan" id="sleeprandom" style="margin-left:20px"/> <label for="sleeprandom" class="tr">Sleep random time</label>
      </span>
    </div>
    <%= _.template($('#back').html())({action:"add", visible:true}) %>
  </script>

  <script type="text/template" id="setvariable">
    <div class="container-fluid setvariable">
      <%= _.template($('#variable_constructor').html())({id:"SetVariableName", description:tr("Name of variable"), default_variable: "NEW_VARIABLE", min_number: -9999999}) %>
      <%= _.template($('#input_constructor').html())({id:"SetVariableValue", description:tr("Value of variable"), default_selector: "string"}) %>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>

  <script type="text/template" id="url">
    <div class="container-fluid url">
      <%= _.template($('#variable_constructor').html())({id:"SaveUrl", description:tr("Variable To Save"), default_variable: "CURRENT_URL"}) %>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>

  <script type="text/template" id="xml">
    <div class="container-fluid xml">
      <%= _.template($('#variable_constructor').html())({id:"SaveXml", description:tr("Variable To Save"), default_variable: "SAVED_XML"}) %>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true, name: tr("Get Element Content")}) %>
    <%= _.template($('#path').html())({selector:selector}) %>
  </script>

  <script type="text/template" id="script">
    <div class="container-fluid script">
      <%= _.template($('#variable_constructor').html())({id:"SaveScript", description:tr("Variable To Save"), default_variable: "SAVED_SCRIPT_RESULT"}) %>
      <%= _.template($('#input_constructor').html())({id:"ScriptValue", description:tr("Script Text"), default_selector: "string", disable_int:true}) %>
      <div class="tooltipinternal tr">Use self variable, which is point to selected element.</div>

    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true, name: tr("Execute Javascript On Element")}) %>
    <%= _.template($('#path').html())({selector:selector}) %>
  </script>

  <script type="text/template" id="text">
    <div class="container-fluid text">
      <%= _.template($('#variable_constructor').html())({id:"SaveText", description:tr("Variable To Save"), default_variable: "SAVED_TEXT"}) %>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true, name: tr("Get Element Text")}) %>
    <%= _.template($('#path').html())({selector:selector}) %>
  </script>

  <script type="text/template" id="clickelement">
    <div class="container-fluid clickelement">
      <div class="tooltipinternal tr">Click on element.</div>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true, name: tr("Click On Element")}) %>
    <%= _.template($('#path').html())({selector:selector}) %>
  </script>

  <script type="text/template" id="moveelement">
    <div class="container-fluid moveelement">
      <div class="tooltipinternal tr">Move mouse pointer on element.</div>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true, name: tr("Move On Element")}) %>
    <%= _.template($('#path').html())({selector:selector}) %>
  </script>

  <script type="text/template" id="moveandclickelement">
    <div class="container-fluid moveandclickelement">
      <div class="tooltipinternal tr">Move mouse pointer and click on element.</div>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true, name: tr("Move And Click On Element")}) %>
    <%= _.template($('#path').html())({selector:selector}) %>
  </script>

  <script type="text/template" id="clear">
    <div class="container-fluid clear">
      <div class="tooltipinternal tr">Clear edit. Works only on edit.</div>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true, name: tr("Clear Edit")}) %>
    <%= _.template($('#path').html())({selector:selector}) %>
  </script>

  <script type="text/template" id="typeelement">
    <div class="container-fluid typeelement">
      <%= _.template($('#input_constructor').html())({id:"TypeData", description:tr("Text to type"), default_selector: "string", disable_int:true}) %>
      <%= _.template($('#input_constructor').html())({id:"TypeInterval", description:tr("Interval in milliseconds"), default_selector: "int", disable_string:true, value_number: 100, step_number: 100, min_number: 0, max_number:10000}) %>

      <%= _.template($('#special_buttons').html())({}) %>

    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true, name: tr("Type Text")}) %>
    <%= _.template($('#path').html())({selector:selector}) %>
  </script>

  <script type="text/template" id="exist">
    <div class="container-fluid exist">
      <%= _.template($('#variable_constructor').html())({id:"Save", description:tr("Variable To Save"), default_variable: "IS_EXISTS"}) %>
      <span data-preserve="true" data-preserve-type="check" data-preserve-id="Check">
        <input type="checkbox" id="Check"/> <label for="Check" class="tr">Also check if visible on a screen</label>
      </span>

      <div class="tooltipinternal tr">Check if element exists.</div>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true, name: tr("Is Element Exists")}) %>
    <%= _.template($('#path').html())({selector:selector}) %>
  </script>

  <script type="text/template" id="style">
    <div class="container-fluid style">
      <%= _.template($('#variable_constructor').html())({id:"Save", description:tr("Variable To Save"), default_variable: "SAVED_STYLE"}) %>
      <%= _.template($('#input_constructor').html())({id:"Value", description:tr("Style To Check"), default_selector: "string", disable_int:true}) %>
     <div class="tooltipinternal tr">Get element style. Use "display" to check if element is visible</div>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true, name: tr("Get Element Style")}) %>
    <%= _.template($('#path').html())({selector:selector}) %>
  </script>

  <script type="text/template" id="check">
    <div class="container-fluid check">
      <div class="tooltipinternal tr">Check cehckbox. Works only on checkboxes.</div>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true, name: tr("Set Checkbox")}) %>
    <%= _.template($('#path').html())({selector:selector}) %>
  </script>

  <script type="text/template" id="waitasyncload">
    <div class="container-fluid waitasyncload">
      <div class="tooltipinternal tr">Wait until page state will be "complete".</div>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>

  <script type="text/template" id="waitelement">
    <span class="path2">
      <div class="container-fluid waitelement">
        <div class="col-xs-12">
          <form class="form-horizontal">
            <div class="form-group">
              <div class="col-xs-6">
                <div class="input-group">
                  <input type="text" class="form-control" aria-label="..." id="selector-input" value="<%= selector["css"] %>">
                  <div class="input-group-btn">
                    <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span id="selector">css</span> <span class="caret"></span></button>
                    <ul class="dropdown-menu dropdown-menu-right">
                      <li><a id="css" class="tr">css</a></li>
                      <li><a id="match" class="tr">match</a></li>
                    </ul>
                  </div>
                  <button type="button" class="btn btn-default res" data-toggle="modal" data-target="#RecourseModal" data-result-target="#selector-input" ><i class="fa fa-database"></i></button>
                  <button type="button" class="btn btn-default varminim" data-toggle="modal" data-target="#VariableModal" data-result-target="#selector-input" ><i class="fa fa-at"></i></button>
                  </div>
                </div>
              </div>
            </form>
          </div>

        <div class="tooltipinternal tr">Wait while matching query element exists on page.</div>
      </div>
      <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
    </span>
  </script>

  <script type="text/template" id="focus">
    <div class="container-fluid focus">
      <div class="tooltipinternal tr">Scroll to element.</div>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true, name: tr("Scroll To Element")}) %>
    <%= _.template($('#path').html())({selector:selector}) %>
  </script>

  <script type="text/template" id="set">
    <div class="container-fluid set">
      <%= _.template($('#input_constructor').html())({id:"Value", description:tr("Set String"), default_selector: "string", disable_int:true}) %>
      <div class="tooltipinternal tr">Set combobox value to desired string. Works only on comboboxes.</div>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true, name: tr("Set Combobox Value")}) %>
    <%= _.template($('#path').html())({selector:selector}) %>
  </script>

  <script type="text/template" id="set_integer">
    <div class="container-fluid set_integer">
      <%= _.template($('#input_constructor').html())({id:"Value", description:tr("Set Index"), default_selector: "int", disable_string:true}) %>
      <div class="tooltipinternal tr">Set combobox index to desired int. Works only on comboboxes.</div>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true, name: tr("Set Combobox Index")}) %>
    <%= _.template($('#path').html())({selector:selector}) %>
  </script>

  <script type="text/template" id="set_random">
    <div class="container-fluid set_random">
      <div class="tooltipinternal tr">Set combobox index to random int. Works only on comboboxes.</div>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true, name: tr("Set Combobox To Random")}) %>
    <%= _.template($('#path').html())({selector:selector}) %>
  </script>

  <script type="text/template" id="attr">
    <div class="container-fluid attr">
      <%= _.template($('#variable_constructor').html())({id:"Save", description:tr("Variable To Save"), default_variable: "SAVED_ATTRIBUTE"}) %>
      <%= _.template($('#input_constructor').html())({id:"Value", description:tr("Attribute Name"), default_selector: "string", disable_int:true}) %>
      <div class="tooltipinternal tr">Get element attribute.</div>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true, name: tr("Get Element Attribute")}) %>
    <%= _.template($('#path').html())({selector:selector}) %>
  </script>

  <script type="text/template" id="set_attr">
    <div class="container-fluid attr">
      <%= _.template($('#input_constructor').html())({id:"Name", description:tr("Attribute Name"), default_selector: "string", disable_int:true}) %>
      <%= _.template($('#input_constructor').html())({id:"Value", description:tr("Attribute Value"), default_selector: "string", disable_int:true}) %>

      <div class="tooltipinternal tr">Set element attribute.</div>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true, name: tr("Set Element Attribute")}) %>
    <%= _.template($('#path').html())({selector:selector}) %>
  </script>

  <script type="text/template" id="captcha">
    <div class="container-fluid captcha">
      <%= _.template($('#variable_constructor').html())({id:"Save", description:tr("Variable To Save"), default_variable: "CAPTCHA_RESULT"}) %>
      <%= _.template($('#input_constructor').html())({id:"Method", description:tr("Solve Method"), default_selector: "string", disable_int:true, value_string: "manual", variants: ["manual","antigate","rucaptcha","2captcha","dbc"], size: 3}) %>
      <%= _.template($('#input_constructor').html())({id:"Antigate", description:tr("Antigate/Rucaptcha/2captcha Key. Can be blank"), default_selector: "string", disable_int:true}) %>
      <%= _.template($('#input_constructor').html())({id:"Dbc", description:tr("DBC Login:Password. Can be blank"), default_selector: "string", disable_int:true}) %>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true, name: tr("Solve Captcha")}) %>
    <%= _.template($('#path').html())({selector:selector}) %>
  </script>


  <script type="text/template" id="length">
    <span class="path2">

    <div class="container-fluid length">
      <%= _.template($('#variable_constructor').html())({id:"Save", description:tr("Variable To Save"), default_variable: "ELEMENT_LENGTH"}) %>

      <div class="col-xs-12">
        <form class="form-horizontal">
          <div class="form-group">
            <div class="col-xs-6">
              <div class="input-group">
                <input type="text" class="form-control" aria-label="..." id="selector-input" value="<%= selector["css"] %>">
                <div class="input-group-btn">
                  <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span id="selector" class="tr">css</span> <span class="caret"></span></button>
                  <ul class="dropdown-menu dropdown-menu-right">
                    <li><a id="css" class="tr">css</a></li>
                    <li><a id="match" class="tr">match</a></li>
                  </ul>
                </div>
                <button type="button" class="btn btn-default res" data-toggle="modal" data-target="#RecourseModal" data-result-target="#selector-input" ><i class="fa fa-database"></i></button>
                <button type="button" class="btn btn-default varminim" data-toggle="modal" data-target="#VariableModal" data-result-target="#selector-input" ><i class="fa fa-at"></i></button>
                </div>
              </div>
            </div>
          </form>
        </div>

      <div class="tooltipinternal tr">Get elements number matching query.</div>
    </div>
    </span>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true, name: tr("Get Element Count")}) %>

  </script>

  <script type="text/template" id="loopelement">
    <span class="path2">

    <div class="container-fluid loopelement">

      <div class="col-xs-12">
        <form class="form-horizontal">
          <div class="form-group">
            <div class="col-xs-6">
              <div class="input-group">
                <input type="text" class="form-control" aria-label="..." id="selector-input" value="<%= selector["css"] %>">
                <div class="input-group-btn">
                  <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span id="selector">css</span> <span class="caret"></span></button>
                  <ul class="dropdown-menu dropdown-menu-right">
                    <li><a id="css">css</a></li>
                    <li><a id="match">match</a></li>
                  </ul>
                </div>
                <button type="button" class="btn btn-default res" data-toggle="modal" data-target="#RecourseModal" data-result-target="#selector-input" ><i class="fa fa-database"></i></button>
                <button type="button" class="btn btn-default varminim" data-toggle="modal" data-target="#VariableModal" data-result-target="#selector-input" ><i class="fa fa-at"></i></button>
                </div>
              </div>
            </div>
          </form>
        </div>

      <div class="tooltipinternal tr">Foreach element, which matching query.</div>
    </div>
    </span>
    <%= _.template($('#back').html())({action:"executeandadd", visible:false, name: tr("Start Loop")}) %>
  </script>

  <script type="text/template" id="move">
    <div class="container-fluid move">
      <%= _.template($('#input_constructor').html())({id:"MoveX", description:tr("Move x position"), default_selector: "int", disable_string:true, value_number: model['x']}) %>
      <%= _.template($('#input_constructor').html())({id:"MoveY", description:tr("Move y position"), default_selector: "int", disable_string:true, value_number: model['y']}) %>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true, name: tr("Move")}) %>
  </script>

  <script type="text/template" id="click">
    <div class="container-fluid click">
      <%= _.template($('#input_constructor').html())({id:"ClickX", description:tr("Click x position"), default_selector: "int", disable_string:true, value_number: model['x']}) %>
      <%= _.template($('#input_constructor').html())({id:"ClickY", description:tr("Click y position"), default_selector: "int", disable_string:true, value_number: model['y']}) %>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true, name: tr("Click")}) %>
  </script>

  <script type="text/template" id="threadnumber">
    <div class="container-fluid threadnumber">
      <%= _.template($('#input_constructor').html())({id:"ThreadNumber", description:tr("Thread number"), default_selector: "int", disable_string:true, disable_string:true, disable_variable:true, min_number: 1}) %>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:false}) %>
  </script>

  <script type="text/template" id="failnumber">
    <div class="container-fluid failnumber">
      <%= _.template($('#input_constructor').html())({id:"FailNumber", description:tr("Fail number"), default_selector: "int", disable_string:true, disable_string:true, disable_variable:true, min_number: 1}) %>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:false}) %>
  </script>

  <script type="text/template" id="successnumber">
    <div class="container-fluid successnumber">
      <%= _.template($('#input_constructor').html())({id:"SuccessNumber", description:tr("Success number"), default_selector: "int", disable_string:true, disable_string:true, disable_variable:true, min_number: 1}) %>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:false}) %>
  </script>

  <script type="text/template" id="moveandclick">
    <div class="container-fluid moveandclick">
      <%= _.template($('#input_constructor').html())({id:"X", description:tr("Move and click x position"), default_selector: "int", disable_string:true, value_number: model['x']}) %>
      <%= _.template($('#input_constructor').html())({id:"Y", description:tr("Move and click y position"), default_selector: "int", disable_string:true, value_number: model['y']}) %>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true, name: tr("Move And Click")}) %>
  </script>

  <script type="text/template" id="type">
    <div class="container-fluid type">
      <%= _.template($('#input_constructor').html())({id:"TypeData", description:tr("Text to type"), default_selector: "string", disable_int:true}) %>
      <%= _.template($('#input_constructor').html())({id:"TypeInterval", description:tr("Interval in milliseconds"), default_selector: "int", disable_string:true, value_number: 100, step_number: 100, min_number: 0, max_number:10000}) %>

      <%= _.template($('#special_buttons').html())({}) %>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true, name: tr("Type Text")}) %>
  </script>

  <script type="text/template" id="resize">
    <div class="container-fluid resize">
      <%= _.template($('#input_constructor').html())({id:"ResizeX", description:tr("Width"), default_selector: "int", disable_string:true,value_number: 1024, step_number: 1, min_number: 100, max_number:10000}) %>
      <%= _.template($('#input_constructor').html())({id:"ResizeY", description:tr("Height"), default_selector: "int", disable_string:true,value_number: 768, step_number: 1, min_number: 100, max_number:10000}) %>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:false}) %>
  </script>

  <script type="text/template" id="proxy">
    <div class="container-fluid" >
      <%= _.template($('#input_constructor').html())({id:"ProxyText", description:tr("Proxy String"), default_selector: "string", disable_int:true}) %>

      <div class="col-xs-12">
        <form class="form-horizontal">
          <div class="form-group">
            <div class="col-xs-2">
              <div class="input-group">
                <span data-preserve="true" data-preserve-type="select" data-preserve-id="ProxyType">
                  <select class="form-control input-sm" id="ProxyType" placeholder="Function Name">
                      <option value="auto" class="tr">auto</option>
                      <option value="http" selected  class="tr">http</option>
                      <option value="socks5" class="tr">socks5</option>
                  </select>
                </span>
              </div>
            </div>
            <label class="control-label text-right tr" style="padding-top:5px !important;">Proxy Type</label>
          </div>
        </form>
      </div>
      <%= _.template($('#input_constructor').html())({id:"ProxyLogin", description:tr("Proxy Login. Can be blank."), default_selector: "string", disable_int:true}) %>
      <%= _.template($('#input_constructor').html())({id:"ProxyPassword", description:tr("Proxy password. Can be blank."), default_selector: "string", disable_int:true}) %>
    </div>
    <%= _.template($('#back').html())({action:"add", visible:true}) %>
  </script>

  _MACRO_INSERT_INTERFACE_

  <script type="text/template" id="log">
    <div class="container-fluid log">
      <%= _.template($('#input_constructor').html())({id:"LogText", description:tr("Data to Log"), default_selector: "string"}) %>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>

  <script type="text/template" id="solverfailed">
    <div class="container-fluid log">
      <div class="tooltipinternal tr">Use this action if last captcha was solved wrong.</div>
    </div>
    <%= _.template($('#back').html())({action:"executeandadd", visible:true}) %>
  </script>


  <script type="text/template" id="log_code">
      log(<%= text %>)
  </script>

  <script type="text/template" id="solverfailed_code">
      solver_failed()
  </script>

  
  <script type="text/template" id="emailsettings_code">
      imap_client_set_config(<%= host %>, <%= username %>, <%= password %>, <%= port %>, <%= encryption %>, <%= inbox %>)
  </script>
  <script type="text/template" id="emailproxy_code">
      var hash = proxy_parse(<%= ProxyText %>)
      <% if( ProxyType != "auto" ){ %>
        hash["IsHttp"] = <%= ( ProxyType == "http" ) ? "true": "false" %>
      <% } %>
      var login = <%= ProxyLogin %>
      var password = <%= ProxyPassword %>
      if(login.length > 0 && password.length > 0 )
      {
        hash["name"] = login
        hash["password"] = password
      }
      imap_client_set_proxy(hash["server"], hash["Port"], hash["IsHttp"], hash["name"], hash["password"])
  </script>
  <script type="text/template" id="emaillength_code">
      imap_client_pull_messages_length()!
      <%= variable %> = imap_client_messages_length()
  </script>
  <script type="text/template" id="emailsearchfirst_code">
      imap_client_search(<%= sender %>,<%= subject %>,<%= body %>)!
      <%= variable %> = imap_client_search_result()
      if(<%= variable %>.length > 0)
        <%= variable %> = <%= variable %>[<%= variable %>.length - 1]
      else
        <%= variable %> = ""
      imap_client_pull_message(<%= variable %>)!
      <%= variable %> = imap_client_message()

      var csv_parse_result = <%= variable %>.match(LINK_REGEXP) || []
      <% for(var i = 0;i < link_list.length; i++){ %>
        VAR_<%= link_list[i] %> = csv_parse_result[<%= i %>]
        if(typeof(VAR_<%= link_list[i] %>) == 'undefined' || !VAR_<%= link_list[i] %>)
        {
          VAR_<%= link_list[i] %> = ""
        }
      <% } %>
  </script>
  <script type="text/template" id="emailsearchall_code">
      imap_client_search(<%= sender %>,<%= subject %>,<%= body %>)!
      <%= variable %> = imap_client_search_result().join(",")
  </script>
  <script type="text/template" id="emailpull_code">
      imap_client_pull_message(<%= value %>)!
      <%= variable %> = imap_client_message()
      var csv_parse_result = <%= variable %>.match(LINK_REGEXP) || []
      <% for(var i = 0;i < link_list.length; i++){ %>
        VAR_<%= link_list[i] %> = csv_parse_result[<%= i %>]
        if(typeof(VAR_<%= link_list[i] %>) == 'undefined' || !VAR_<%= link_list[i] %>)
        {
          VAR_<%= link_list[i] %> = ""
        }
      <% } %>
  </script>
             
  <script type="text/template" id="httpclientproxy_code">
      var hash = proxy_parse(<%= ProxyText %>)
      <% if( ProxyType != "auto" ){ %>
        hash["IsHttp"] = <%= ( ProxyType == "http" ) ? "true": "false" %>
      <% } %>
      var login = <%= ProxyLogin %>
      var password = <%= ProxyPassword %>
      if(login.length > 0 && password.length > 0 )
      {
        hash["name"] = login
        hash["password"] = password
      }
      http_client_set_proxy(hash["server"], hash["Port"], hash["IsHttp"], hash["name"], hash["password"])
  </script>
  <script type="text/template" id="httpclientreset_code">
    new_http_client()
  </script>
  <script type="text/template" id="httpclientdownload_code">
    http_client_download(<%= value %>, <%= file %>)!
  </script>
  <script type="text/template" id="httpclientget_code">
    <% if(follow){ %>
      http_client_get(<%= value %>)!
    <% } else {%>
      http_client_get_no_redirect(<%= value %>)!
    <% }%>
  </script>
  <script type="text/template" id="httpclientpost_code">
    <% if(follow){ %>
      http_client_post(<%= value %>, <%= params %>, <%= multipart %>)!
    <% } else {%>
      http_client_post_no_redirect(<%= value %>, <%= params %>, <%= multipart %>)!
    <% }%>
  </script>
  <script type="text/template" id="parseline_code">
    var csv_parse_result = csv_parse(<%= value %>)
    <% for(var i = 0;i < list.length; i++){ %>
      VAR_<%= list[i] %> = csv_parse_result[<%= i %>]
      if(typeof(VAR_<%= list[i] %>) == 'undefined' || !VAR_<%= list[i] %>)
      {
        VAR_<%= list[i] %> = ""
      }
    <% } %>
    
  </script>

  
  <script type="text/template" id="httpclienturl_code">
    <%= variable %> = http_client_url()
  </script>
  <script type="text/template" id="httpclientcontent_code">
    <%= variable %> = http_client_content()
  </script>
  <script type="text/template" id="httpclientstatus_code">
    <%= variable %> = http_client_status()
  </script>
  <script type="text/template" id="httpclientgetheader_code">
    <%= variable %> = http_client_header(<%= value %>)
  </script>
  <script type="text/template" id="httpclientsetheader_code">
    http_client_set_header(<%= name %>, <%= value %>)
  </script>
  <script type="text/template" id="httpclientclearheader_code">
    http_client_clear_header()
  </script>
  <script type="text/template" id="httpclientgetcookiesforurl_code">
    <%= variable %> = http_client_get_cookies(<%= value %>)
  </script>
  <script type="text/template" id="httpclientsavecookies_code">
    <%= variable %> = http_client_save_cookies()
  </script>
  <script type="text/template" id="httpclientrestorecookies_code">
    http_client_restore_cookies(<%= value %>)
  </script>
  <script type="text/template" id="httpclientfailonerror_code">
    http_client_set_fail_on_error(<%= value %> == "fail")
  </script>
  <script type="text/template" id="httpclientiserror_code">
    <%= variable %> = http_client_was_error()
  </script>
  <script type="text/template" id="httpclientgeterrorstring_code">
    <%= variable %> = http_client_error_string()
  </script>
  <script type="text/template" id="httpclientxpathxml_code">
    <%= variable %> = http_client_xpath_xml(<%= value %>,<%= fail %>)
  </script>
  <script type="text/template" id="httpclientxpathtext_code">
    <%= variable %> = http_client_xpath_text(<%= value %>,<%= fail %>)
  </script>
  <script type="text/template" id="httpclientxpathcount_code">
    <%= variable %> = http_client_xpath_count(<%= value %>)
  </script>
  <script type="text/template" id="httpclientxpathexists_code">
    <%= variable %> = http_client_xpath_exist(<%= value %>)
  </script>


  <script type="text/template" id="executefunction_code">
      _call(<%= name %>,null)!
  </script>

  <script type="text/template" id="xml_code">
      /*Browser*/
      <%= waiter %>
      <%= path %>.xml()!
      <%= variable %> = _result()
  </script>

  <script type="text/template" id="captcha_code">
      /*Browser*/
      if(<%= method %> == "rucaptcha")
      {
        solver_property("rucaptcha","coordinatescaptcha","")
        rucaptcha(<%= antigate %>)
      }
      if(<%= method %> == "antigate")
      {
        antigate(<%= antigate %>)
      }
      if(<%= method %> == "dbc")
      {
        dbc(<%= dbc %>)
      }
      if(<%= method %> == "2captcha")
      {
        solver_property("2captcha","coordinatescaptcha","")
        twocaptcha(<%= antigate %>)
      }

      <%= waiter %>

      <%= path %>.render_base64()!
      solve_base64(<%= method %>, _result())!
      <%= variable %> = _result()
  </script>

  _MACRO_INSERT_CODE_

  <script type="text/template" id="exist_code">
      /*Browser*/
      <%= path %>.exist()!
      <%= variable %> = _result() == 1
      <% if(isvisible){ %>
        _if(<%= variable %>, function(){
          <%= path %>.style("display")!
          STYLE_DISPLAY = _result()

          <%= path %>.script("self.getBoundingClientRect().height")!
          STYLE_HEIGHT = _result()

          <%= path %>.script("self.getBoundingClientRect().width")!
          STYLE_WIDTH = _result()
          
          <%= variable %> = STYLE_DISPLAY != "none" && STYLE_HEIGHT != "0"  && STYLE_WIDTH != "0"
          
        })!
      <% } %>

  </script>

  <script type="text/template" id="restorecookies_code">
      /*Browser*/
      restore_cookies(<%= value %>)!
  </script>

  <script type="text/template" id="setheader_code">
    /*Browser*/
    header(<%= name %>, <%= value %>)!
  </script>

  <script type="text/template" id="solvecaptcha_code">
      /*Browser*/
      if(<%= method %> == "rucaptcha")
      {
        solver_property("rucaptcha","coordinatescaptcha","")
        rucaptcha(<%= antigate %>)
      }
      if(<%= method %> == "antigate")
      {
        antigate(<%= antigate %>)
      }
      if(<%= method %> == "dbc")
      {
        dbc(<%= dbc %>)
      }
      if(<%= method %> == "2captcha")
      {
        solver_property("2captcha","coordinatescaptcha","")
        twocaptcha(<%= antigate %>)
      }


      solve_base64(<%= method %>,<%= value %>)!
      <%= variable %> = _result()
  
  </script>

  <script type="text/template" id="timeout_code">
      <% if(isgeneral){ %>
        general_timeout(<%= timeout %>)
      <% }else{ %>
        solver_timeout(<%= timeout %>)
      <% } %>
  </script>

  <script type="text/template" id="savecookies_code">
      /*Browser*/
      save_cookies()!
      <%= variable %> = _result()
  </script>

  <script type="text/template" id="style_code">
      /*Browser*/
      <%= waiter %>
      <%= path %>.style(<%= style %>)!
      <%= variable %> = _result()
  </script>

  <script type="text/template" id="typeelement_code">
      /*Browser*/
      <%= waiter %>
      <%= path %>.move()!
      <%= path %>.type(<%= text %>,<%= interval %>)!
  </script>

  <script type="text/template" id="clear_code">
      /*Browser*/
      <%= waiter %>
      <%= path %>.move()!
      <%= path %>.clear()!
  </script>

  <script type="text/template" id="clickelement_code">
      /*Browser*/
      <%= waiter %>
      <%= path %>.system_click()!
  </script>

  <script type="text/template" id="check_code">
      /*Browser*/
      <%= waiter %>
      <%= path %>.move()!
      <%= path %>.check()!
  </script>

  <script type="text/template" id="focus_code">
      /*Browser*/
      <%= waiter %>
      <%= path %>.focus()!
  </script>

  <script type="text/template" id="reset_code">
      /*Browser*/
      reset()!
  </script>

  <script type="text/template" id="moveelement_code">
      /*Browser*/
      <%= waiter %>
      <%= path %>.move()!
  </script>

  <script type="text/template" id="moveandclickelement_code">
      /*Browser*/
      <%= waiter %>
      <%= path %>.move()!
      <%= path %>.system_click()!
  </script>

  <script type="text/template" id="text_code">
      /*Browser*/
      <%= waiter %>
      <%= path %>.text()!
      <%= variable %> = _result()
  </script>

  <script type="text/template" id="length_code">
      /*Browser*/
      <%= path %>.length()!
      <%= variable %> = _result()
  </script>

  <script type="text/template" id="script_code">
      /*Browser*/
      <%= waiter %>
      <%= path %>.script(<%= script %>)!
      <%= variable %> = _result()
  </script>

  <script type="text/template" id="javascript_code">
      /*Browser*/
      page().script(<%= value %>)!
      <%= variable %> = _result()
  </script>

  
  <script type="text/template" id="set_code">
      /*Browser*/
      <%= waiter %>
      <%= path %>.move()!
      <%= path %>.set(<%= set %>)!
  </script>

  <script type="text/template" id="waitelement_code">
      /*Browser*/
      <%= waiter %>
  </script>

  <script type="text/template" id="waitasyncload_code">
      /*Browser*/
      wait_async_load()!
  </script>

  <script type="text/template" id="set_integer_code">
      /*Browser*/
      <%= waiter %>
      <%= path %>.move()!
      <%= path %>.set_integer(<%= set %>)!
  </script>

  <script type="text/template" id="set_random_code">
      /*Browser*/
      <%= waiter %>
      <%= path %>.move()!
      <%= path %>.set_random()!
  </script>

  <script type="text/template" id="attr_code">
      /*Browser*/
      <%= waiter %>
      <%= path %>.attr(<%= attr %>)!
      <%= variable %> = _result()
  </script>

  <script type="text/template" id="set_attr_code">
      /*Browser*/
      <%= waiter %>
      <%= path %>.set_attr(<%= name %>, <%= value %>)!
  </script>

  <script type="text/template" id="url_code">
      /*Browser*/
      url()!
      <%= variable %> = _result()
  </script>

  <script type="text/template" id="setvariable_code">
      <%= variable_name %> = <%= variable_value %>
  </script>

  <script type="text/template" id="resource_code">
      RS("<%= je(resource) %>", <%= notreuse %>, <%= onlyfail %>)!
      <%= variable %> = _result().get()
  </script>

  <script type="text/template" id="click_code">
      /*Browser*/
      mouse(<%= x %>,<%= y %>)!
  </script>

  <script type="text/template" id="move_code">
      /*Browser*/
      move(<%= x %>,<%= y %>)!
  </script>

  <script type="text/template" id="moveandclick_code">
      /*Browser*/
      move(<%= x %>,<%= y %>)!
      mouse(<%= x %>,<%= y %>)!
  </script>

  <script type="text/template" id="load_code">
      /*Browser*/
      load(<%= url %>)!
  </script>

  <script type="text/template" id="resize_code">
      /*Browser*/
      resize(<%= width %>, <%= height %>)!
  </script>

  <script type="text/template" id="sleep_fromto_code">
      sleep(rand(<%= from %>,<%= to %>))!
  </script>

  <script type="text/template" id="sleep_code">
      sleep(<%= t %>)!
  </script>


  <script type="text/template" id="result_code">
    result(<%= value %>, <%= number %>)
  </script>
  
  
  <script type="text/template" id="base64_code">
    <% if(encode) { %>
      <%= variable %> = base64_encode(<%= value %>)
    <% }else{ %>
      <%= variable %> = base64_decode(<%= value %>)
    <% } %>  </script>
  <script type="text/template" id="globalset_code">
    var val = <%= value %>;
    if(typeof(val) == "number")
      val = "i" + val.toString();
    else
      val = "s" + val.toString();
    PSet(<%= group %>, <%= key %>, val)
  </script>
  <script type="text/template" id="globalget_code">
    <%= variable %> = P(<%= group %>, <%= key %>)
    if(<%= variable %>.indexOf("i")==0)
      <%= variable %> = parseInt(<%= variable %>.slice(1))
    else if(<%= variable %>.indexOf("s")==0)
      <%= variable %> = <%= variable %>.slice(1)
  </script>


  <script type="text/template" id="cachemaskallow_code">
    /*Browser*/
    cache_allow(<%= value %>)!
  </script>

  <script type="text/template" id="cachemaskdeny_code">
    /*Browser*/
    cache_deny(<%= value %>)!
  </script>

  <script type="text/template" id="requestmaskallow_code">
    /*Browser*/
    request_allow(<%= value %>)!
  </script>

  <script type="text/template" id="requestmaskdeny_code">
    request_deny(<%= value %>)!
  </script>

  <script type="text/template" id="cleardata_code">
    /*Browser*/
    cache_data_clear()!
  </script>

  <script type="text/template" id="clearmasks_code">
    /*Browser*/
    cache_masks_clear()!
  </script>

  <script type="text/template" id="getstatus_code">
    /*Browser*/
    cache_get_status(<%= value %>)!
    <%= variable %> = _result()
  </script>

  <script type="text/template" id="isloaded_code">
    /*Browser*/
    is_load(<%= value %>)!
    <%= variable %> = _result()
  </script>

  <script type="text/template" id="getfromcache_code">
    /*Browser*/
    wait_load(<%= value %>)!
    <% if(base64){ %>
      cache_get_base64(<%= value %>)!
      <%= variable %> = _result()
    <% }else{ %>
      cache_get_string(<%= value %>)!
      <%= variable %> = _result()
    <% } %>
  </script>

  <script type="text/template" id="renderscreen_code">
      /*Browser*/
      render(<%= x %>,<%= y %>,<%= width %>,<%= height %>)!
      <%= variable %> = _result()
  </script>

  <script type="text/template" id="scroll_code">
      /*Browser*/
      scroll(<%= x %>,<%= y %>)!
  </script>

  <script type="text/template" id="waitload_code">
      /*Browser*/
      wait_load(<%= waiter %>)!
  </script>

  <script type="text/template" id="waiturl_code">
      /*Browser*/
      wait_url(<%= waiter %>)!
  </script>

  <script type="text/template" id="openfile_code">
      /*Browser*/
      open_file_dialog(<%= value %>)!
  </script>

  <script type="text/template" id="promptresult_code">
      /*Browser*/
      prompt_result(<%= value %>)!
  </script>

  <script type="text/template" id="httpauth_code">
      /*Browser*/
      http_auth_result(<%= login %>,<%= password %>)!
  </script>

  <script type="text/template" id="waitcontent_code">
      /*Browser*/
      wait_content(<%= waiter %>)!
  </script>

  <script type="text/template" id="waitcss_code">
      /*Browser*/
      wait_css(<%= waiter %>)!
  </script>

  <script type="text/template" id="type_code">
      /*Browser*/
      page().type(<%= text %>,<%= interval %>)!
  </script>

  <script type="text/template" id="html_code">
      /*Browser*/
      page().xml()!
      <%= variable %> = _result()
  </script>

  <script type="text/template" id="if_code">
      _if(<%= expression %>,function(){
        section_insert()
      })!
  </script>

  <script type="text/template" id="proxy_code">
      /*Browser*/
      var hash = proxy_parse(<%= ProxyText %>)
      <% if( ProxyType != "auto" ){ %>
        hash["IsHttp"] = <%= ( ProxyType == "http" ) ? "true": "false" %>
      <% } %>
      var login = <%= ProxyLogin %>
      var password = <%= ProxyPassword %>
      if(login.length > 0 && password.length > 0 )
      {
        hash["name"] = login
        hash["password"] = password
      }
      set_proxy(hash["server"], hash["Port"], hash["IsHttp"], hash["name"], hash["password"])!
  </script>

  <script type="text/template" id="for_code">
      _do(function(){
        VAR_CYCLE_INDEX = _iterator() - 1 + <%= expression_from %>
        if(VAR_CYCLE_INDEX > <%= expression_to %>)_break();
        section_insert()
      })!
  </script>

  <script type="text/template" id="foreach_code">
      FOREACH_ARRAY = <%= for_array %>
      _do(function(){
        VAR_CYCLE_INDEX = _iterator() - 1
        if(VAR_CYCLE_INDEX > FOREACH_ARRAY.length - 1)_break();
        VAR_FOREACH_DATA = FOREACH_ARRAY[VAR_CYCLE_INDEX]
        section_insert()
      })!
  </script>

  <script type="text/template" id="loopelement_code">
      /*Browser*/
      <%= waiter %>
      <%= path %>.length()!
      ELEMENT_LENGTH = _result()
      VAR_FOR_EACH_CSS = "<%= querycss %>"
      VAR_FOR_EACH_MATCH = "<%= querymatch %>"

      _do(function(){
        VAR_CYCLE_INDEX = _iterator() - 1
        if(VAR_CYCLE_INDEX >= ELEMENT_LENGTH)_break();
        section_insert()
      })!
  </script>

  <script type="text/template" id="while_code">
      _do(function(){
        VAR_CYCLE_INDEX = _iterator() - 1
        <%= additional %>
        BREAK_CONDITION = <%= expression %>;
        if(!BREAK_CONDITION)_break();
        section_insert()
      })!
  </script>

  
  <script type="text/template" id="getcookiesforurl_code">
      /*Browser*/
      get_cookies(<%= value %>)!
      <%= variable %> = _result()
  </script>

  <script type="text/template" id="break_code">
      _break(<%= depth %>)
  </script>

  <script type="text/template" id="continue_code">
      _next()
  </script>

  <script type="text/template" id="success_code">
      success()
  </script>

  <script type="text/template" id="fail_code">
      fail(<%= message %>)
  </script>

  <script type="text/template" id="custom_code">
      <%= code %>
  </script>

  <!-- ========= -->
  <!-- Libraries -->
  <!-- ========= -->
  <script src="jquery-2.1.3.min.js" type="text/javascript"></script>
  <script src="jquery.mousewheel.js" type="text/javascript"></script>
  <script src="lodash.js" type="text/javascript"></script>
  <script src="backbone.js" type="text/javascript"></script>
  <script src="bootstrap.min.js"></script>
  <script src="bootbox.min.js"></script>
  <script src="translate.js"></script>
  <script src="expressioneditor.js"></script>
  <script src="rappid.js"></script>
  <script src="tooledViewPlugin.js"></script>
  

  <script type="text/javascript"> _MACRO_INSERT_LOCALIZE_ </script>

  <!-- ========= -->
  <!--   Styles  -->
  <!-- ========= -->
  <link rel="stylesheet" href="bootstrap.min.css">
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="font-awesome.min.css">
  <link rel="stylesheet" href="expressioneditor.css">
  <link rel="stylesheet" href="rappid.css">



  <!-- =============== -->
  <!-- Javascript code -->
  <!-- =============== -->
  <script type="text/javascript">
    var TaskModel = Backbone.Model.extend({
        defaults: {
            name: "",
            description: "",
            ref: ""
        }
    });
    var ResourceModel = Backbone.Model.extend({
        defaults: {
            name: "",
            description: ""
        }
    });
    var VariableModel = Backbone.Model.extend({
        defaults: {
            name: ""
        }
    });
    var FunctionModel = Backbone.Model.extend({
        defaults: {
            name: ""
        }
    });
    var GobalModel = Backbone.Model.extend({
        defaults: {
            state: "main",
            isedit: false,
            x: "",
            y: ""
        },
        GetPageInfo: function()
        {
          var state = this.get("state")
          var task = _TaskCollection.find(function(item){
            return item.get("ref") == state
          });
          if(task)
            return task.get("name")

          return null;
          
        }
    });
    var SelectorModel = Backbone.Model.extend({
        defaults: {
            css: "",
            match: "",
            mousex: 0,
            mousey: 0,
            current: "css"
        }
    });

    var TaskCollection = Backbone.Collection.extend({
        model: TaskModel
    });
    var ResourceCollection = Backbone.Collection.extend({
        model: ResourceModel
    });
    var VariableCollection = Backbone.Collection.extend({
        model: VariableModel
    });
    var FunctionCollection = Backbone.Collection.extend({
        model: FunctionModel
    });

    var MainView = Backbone.View.extend({
      el: '#container',

      currentInputResource: "none",
      currentInputVariable: "none",

      events: {
        "click #ok": "accept",
        //"mouseover .toolbutton": "showtooltip",
        "click #backtomain": "backtomain",
        "show.bs.modal #VariableModal": "varaddstart",
        "click .varok": "varadd",
        "show.bs.modal #FunctionModal": "funcaddstart",
        "click .funcok": "funcadd",
        "show.bs.modal #RecourseModal": "resaddstart",
        "click .resok": "resadd",
        "click .edit": "editstart",
        "click .specialletter": "specialletter",
        "click #executetype button":"clickexecutetype",
        "click #css":"css",
        "click #match":"match",
        "click #at":"at",
        "click #none":"none",
        "click .string": "string",
        "click .expression": "expression",
        "click .int": "int",
        "change .groupselector": "groupselector",
        "click .variant": "selectvariant",
        "click .addtopost": "addpostdata"

     },

      editstart: function(event)
      {
        $("#containerdata").hide()
        var target = $(event.target).closest(".btn")
        var selector = target.attr("data-result-target")
        ToolboxMaximizeCallback = function()
        {
          $("#expressioneditor-container").show()
          //Get original value
          var value = null
          var data = null
          {
            var Loader = new ResourceLoader()
            Loader.SetIsPrerender(true)
            var id = target.closest("*[data-preserve-id]").attr("data-preserve-id")
            //console.log(id)
            var V = GetInputConstructorValue(id,Loader)
            data = target.closest("*[data-preserve-id]").attr("data-preserve-json")
            if(typeof(data) == "undefined")
              data = ""

            value = V["updated"]
          }
          _ExpressionEditor = new ExpressionEditor(function(Result){
            $("#containerdata").show()
            BrowserAutomationStudio_Minimize()
            $("#expressioneditor-container").hide()
            if(Result["ok"])
            {
              target.closest("*[data-preserve-id]").attr("data-preserve-json",Result["data"])
              $(selector).val(Result["res"])
              $(selector).closest(".input-group").find(".selector").html("expression")
              $(selector).closest(".input-group").find(".input_selector_number").hide()
              $(selector).closest(".input-group").find(".input_selector_string").show()
            }
          },value,data)
        };
        BrowserAutomationStudio_Maximize();
      },

      backtomain: function()
      {
        BrowserAutomationStudio_EditCancel();
      },
      
      addpostdata: function(event)
      {
        var loader = new ResourceLoader();
        var Name = GetInputConstructorValue("PostName",loader)["updated"]
        var Value = GetInputConstructorValue("PostValue",loader)["updated"]

        var Data = $("#PostData").val()
        if(Name.length > 0 && Value.length > 0)
        {
          if(Data.length === 0)
          {
            $("#PostData").val(Name  + ":" + Value);
          }else
          {
            $("#PostData").val(Data + "," + Name  + ":" + Value)
          }
          $("#PostName").val("")
          $("#PostValue").val("")
        }
        
      },

      selectvariant: function(event)
      {
          var target = $(event.target)
          var variant = target.attr("data-variant")
          var result = $("#" + target.attr("data-result"))
          result.closest(".input-group").find(".selector").html("string")
          result.closest(".input-group").find(".input_selector_number").hide()
          result.closest(".input-group").find(".input_selector_string").show()
          result.closest(".input-group").find(".input_selector_string").val(variant)
      },

      groupselector: function(event)
      {
          var target = $(event.target)
          if(target.is(':checked'))
          {
            $("#" + target.attr("data-unchecked-group-id")).hide()
            $("#" + target.attr("data-checked-group-id")).show()
          }
          else
          {
            $("#" + target.attr("data-unchecked-group-id")).show()
            $("#" + target.attr("data-checked-group-id")).hide()
          }
      },

      string: function(event)
      {
        $(event.target).closest(".input-group").find(".selector").html("string")
        $(event.target).closest(".input-group").find(".input_selector_number").hide()
        $(event.target).closest(".input-group").find(".input_selector_string").show()
      },

      int: function(event)
      {
        $(event.target).closest(".input-group").find(".selector").html("int")
        $(event.target).closest(".input-group").find(".input_selector_number").show()
        $(event.target).closest(".input-group").find(".input_selector_string").hide()
      },

      expression: function(event)
      {
        $(event.target).closest(".input-group").find(".selector").html("expression")
        $(event.target).closest(".input-group").find(".input_selector_number").hide()
        $(event.target).closest(".input-group").find(".input_selector_string").show()
      },

      updatepath: function()
      {
        var current = _SelectorModel.get("current")
        
        if(current == "css")
          this.css()
        else if(current == "match")
          this.match()
        else if(current == "at")
          this.at()
        else if(current == "none")
          this.none()
      },

      css:function(event)
      {
        $("#selector").html("css")
        $("#selector-input").removeAttr("disabled").val(_SelectorModel.get("css"))
        _SelectorModel.set("current","css")
      },

      match:function(event)
      {
        $("#selector").html("match")
        $("#selector-input").removeAttr("disabled").val(_SelectorModel.get("match"))
        _SelectorModel.set("current","match")
      },

      at:function(event)
      {
        $("#selector").html("at")
        $("#selector-input").removeAttr("disabled").val(_SelectorModel.get("mousex") + ", " + _SelectorModel.get("mousey"))
        _SelectorModel.set("current","at")
      },

      none:function(event)
      {
        $("#selector").html("none")
        $("#selector-input").attr("disabled","disabled").val("")

        _SelectorModel.set("current","none")
      },

      clickexecutetype:function(event)
      {
          $("#executetype button").removeClass("btn-info")
          $("#executetype button").addClass("btn-default")
          $(event.target).removeClass("btn-default")
          $(event.target).addClass("btn-info")
      },

      specialletter: function(event)
      {
        InsertAtCaret("TypeData","<" + $(event.target).html() + ">");
      },

      resaddstart: function(event)
      {
        console.log("resaddstart")
        var json = _ResourceCollection.toJSON();
        $('#RecourseName').html("")
        if(json.length == 0)
        {
          $("#NoResources").show()
          $("#RecourseControls").hide()
          $(".resok").hide()

        }else
        {
          $("#NoResources").hide()
          $("#RecourseControls").show()
          $("#ResourceReuse").prop('checked', true);
          $("#ResourceDontDie").prop('checked', false);
          $(".resok").show()
          for(var i = 0;i<json.length;i+=1)
          {
            $('#RecourseName')
             .append($("<option></option>")
             .attr("value",json[i]["name"])
             .text(json[i]["name"] + ": " + json[i]["description"]));
           }
         }

        $('#RecourseName').focus()
        this.currentInputResource = $(event.relatedTarget).attr("data-result-target")
      },

      varaddstart: function(event)
      {
        console.log("varaddstart")
        var json = _VariableCollection.toJSON();
        $('#VariableName').html("")
        if(json.length == 0)
        {
          $("#NoVariable").show()
          $("#VariableName").hide()
          $(".varok").hide()

        }else
        {
          $("#NoVariable").hide()
          $("#VariableName").show()
          $(".varok").show()
          for(var i = 0;i<json.length;i+=1)
          {
            $('#VariableName')
             .append($("<option></option>")
             .attr("value",json[i]["name"])
             .text(json[i]["name"]));
           }
         }

        $('#VariableName').focus()
        this.currentInputVariable = $(event.relatedTarget).attr("data-result-target")
      },

      funcaddstart: function(event)
      {
        var json = _FunctionCollection.toJSON();

        $('#FunctionNameInput').html("")
        if(json.length == 0)
        {
          $("#NoFunctionFound").show()
          $("#FunctionNameInput").hide()
          $(".funcok").hide()

        }else
        {
          $("#NoFunctionFound").hide()
          $("#FunctionNameInput").show()
          $(".funcok").show()
          for(var i = 0;i<json.length;i+=1)
          {
            $('#FunctionNameInput')
             .append($("<option></option>")
             .attr("value",json[i]["name"])
             .text(json[i]["name"]));
           }
         }

        $('#FunctionNameInput').focus()
        this.currentInputVariable = $(event.relatedTarget).attr("data-result-target")

      },

      resadd: function(event)
      {
        var el = $(this.currentInputResource)
        var isnumber = $(this.currentInputResource + "_number:visible").length > 0

        var res = $("#RecourseName").val();
        if(!$("#ResourceReuse").is(':checked'))
          res+="|notreuse";
        if($("#ResourceDontDie").is(':checked'))
          res+="|onlyfail";

        if(isnumber)
        {
          el.closest(".input-group").find(".selector").html("expression")
          el.closest(".input-group").find(".input_selector_number").hide()
          el.closest(".input-group").find(".input_selector_string").show()
          
          el.val("{{" + res + "}}")
        }else
        {
          var name = $("#RecourseName").val();
          if(name.length > 0)
          {
            if(el.is("[data-resource-constructor]"))
            {
              el.val(res)
            }else
            {
              el.val(el.val() + "{{" + res + "}}")
            }
          }
        }

      },

      varadd: function(event)
      {

        var el = $(this.currentInputVariable)
        var isnumber = $(this.currentInputVariable + "_number:visible").length > 0

        if(isnumber)
        {
          el.closest(".input-group").find(".selector").html("expression")
          el.closest(".input-group").find(".input_selector_number").hide()
          el.closest(".input-group").find(".input_selector_string").show()
          el.val("[[" + $("#VariableName").val() + "]]")
        }else
        {

          var name = $("#VariableName").val();
          if(name.length > 0)
          {
            if(!el.is("[data-variable-constructor]"))
            {
              el.val(el.val() + "[[" + $("#VariableName").val() + "]]")
            }else
            {
              if(el.is("[data-append-array]"))
              {
                if(el.val().length == 0)
                  el.val($("#VariableName").val())
                else
                  el.val(el.val() + "," + $("#VariableName").val())
              }else
              {
                el.val($("#VariableName").val())
              }
            }
          }
        }
      },

      funcadd: function(event)
      {
        var el = $(this.currentInputVariable)

        var name = $("#FunctionNameInput").val();
        if(name.length > 0)
        {
          el.val($("#FunctionNameInput").val())
        }
      },

      accept: function()
      {
          var State = this.model.get("state");
          var loader = new ResourceLoader();

          var action = $("#executetype .btn-info").attr("data-action")
          if(typeof(action) == "undefined")
          {
            action = 2
          }else if(action == "execute")
          {
            action = 0
          }else if(action == "add")
          {
            action = 1
          }else if(action == "executeandadd")
          {
            action = 2
          }

          var DisableIfAdd = true
          if(_GobalModel.get("isedit"))
          {
            DisableIfAdd = action == 1
            action = 1
          }


          if(State == "load")
          {
            var val = GetInputConstructorValue("LoadUrl",loader)

            if(val["original"].length > 0)
            {
               try{
                var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({url:val["updated"]})
                code = Normalize(code,0)

                BrowserAutomationStudio_Append("Load " + val["original"], BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
              }catch(e)
              {}
            }else
            {
              Invalid("Url is empty");
              return;
            }
          }else if(State == "httpclientxpathxml")
          {

            var Save = this.$el.find("#Save").val().toUpperCase();
            var Value = GetInputConstructorValue("Value", loader);
            var fail = $("#Check").is(':checked')


            if(Save.length == 0)
            {
              Invalid("Variable is empty");
              return;
            }
            if(Value["original"].length == 0)
            {
              Invalid("Query is empty");
              return;
            }
             try{
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({variable:"VAR_" + Save,value: Value["updated"], fail:fail})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Get xml from xpath " + Value["original"], BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}

          }else if(State == "waitelement")
          {
             try{
              var path = GetPath(loader,true)
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({waiter: path["waiter"]})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Wait while element " + path["raw"] + " appear on page", BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}
          }else if(State == "waitasyncload")
          {
             try{
              var code = _.template($('#' + State + "_code").html())({})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Wait until page fully loaded", BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}
          }else if(State == "httpclientxpathtext")
          {

            var Save = this.$el.find("#Save").val().toUpperCase();
            var Value = GetInputConstructorValue("Value", loader);
            var fail = $("#Check").is(':checked')


            if(Save.length == 0)
            {
              Invalid("Variable is empty");
              return;
            }
            if(Value["original"].length == 0)
            {
              Invalid("Query is empty");
              return;
            }
             try{
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({variable:"VAR_" + Save,value: Value["updated"], fail:fail})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Get text from xpath " + Value["original"], BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}

          }else if(State == "httpclientxpathcount")
          {

            var Save = this.$el.find("#Save").val().toUpperCase();
            var Value = GetInputConstructorValue("Value", loader);

            if(Save.length == 0)
            {
              Invalid("Variable is empty");
              return;
            }
            if(Value["original"].length == 0)
            {
              Invalid("Query is empty");
              return;
            }
             try{
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({variable:"VAR_" + Save,value: Value["updated"]})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Get count from xpath " + Value["original"], BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}

          }else if(State == "httpclientxpathexists")
          {

            var Save = this.$el.find("#Save").val().toUpperCase();
            var Value = GetInputConstructorValue("Value", loader);

            if(Save.length == 0)
            {
              Invalid("Variable is empty");
              return;
            }
            if(Value["original"].length == 0)
            {
              Invalid("Query is empty");
              return;
            }
             try{
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({variable:"VAR_" + Save,value: Value["updated"]})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Check if xpath exists", BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}

          }else if(State == "httpclientfailonerror")
          {
            var Value = GetInputConstructorValue("SetFailed",loader)

            if(Value["original"].length <= 0)
            {
              Invalid("Value is empty");
              return;
            }

             try{
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({value:Value["updated"]})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Set http client fail on error", BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}
          
            
          }else if(State == "httpclienturl")
          {

            var Save = this.$el.find("#Save").val().toUpperCase();

            if(Save.length == 0)
            {
              Invalid("Variable is empty");
              return;
            }
             try{
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({variable:"VAR_" + Save})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Http client get url and save to " + Save + " variable", BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}

          }else if(State == "httpclientcontent")
          {

            var Save = this.$el.find("#Save").val().toUpperCase();

            if(Save.length == 0)
            {
              Invalid("Variable is empty");
              return;
            }
             try{
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({variable:"VAR_" + Save})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Http client get content and save to " + Save + " variable", BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}

          }else if(State == "httpclientiserror")
          {

            var Save = this.$el.find("#Save").val().toUpperCase();

            if(Save.length == 0)
            {
              Invalid("Variable is empty");
              return;
            }
             try{
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({variable:"VAR_" + Save})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Http client get is error and save to " + Save + " variable", BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}

          }else if(State == "httpclientgeterrorstring")
          {

            var Save = this.$el.find("#Save").val().toUpperCase();

            if(Save.length == 0)
            {
              Invalid("Variable is empty");
              return;
            }
             try{
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({variable:"VAR_" + Save})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Http client get error string and save to " + Save + " variable", BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}

          }else if(State == "httpclientstatus")
          {

            var Save = this.$el.find("#Save").val().toUpperCase();

            if(Save.length == 0)
            {
              Invalid("Variable is empty");
              return;
            }
             try{
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({variable:"VAR_" + Save})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Http client get status and save to " + Save + " variable", BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}

          }else if(State == "httpclientgetheader")
          {

            var Save = this.$el.find("#Save").val().toUpperCase();
            var Value = GetInputConstructorValue("Value", loader);

            if(Save.length == 0)
            {
              Invalid("Variable is empty");
              return;
            }
            if(Value["original"].length == 0)
            {
              Invalid("Header is empty");
              return;
            }
             try{
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({variable:"VAR_" + Save,value: Value["updated"]})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Get header and save to " + Save + " variable", BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}

          }else if(State == "httpclientsetheader")
          {
            var Name = GetInputConstructorValue("Name",loader)
            var Value = GetInputConstructorValue("Value",loader)

            if(Name["original"].length <= 0)
            {
              Invalid("Name is empty");
              return;
            }
            
             try{
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({name:Name["updated"],value:Value["updated"]})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Set " + Name["original"] + " header" , BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}
            
          }else if(State == "httpclientgetcookiesforurl")
          {

            var Save = this.$el.find("#Save").val().toUpperCase();
            var Value = GetInputConstructorValue("Value", loader);

            if(Save.length == 0)
            {
              Invalid("Variable is empty");
              return;
            }
            if(Value["original"].length == 0)
            {
              Invalid("Url is empty");
              return;
            }
             try{
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({variable:"VAR_" + Save,value: Value["updated"]})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Get cookies for url and save to " + Save + " variable", BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}

          }else if(State == "httpclientrestorecookies")
          {
            var Value = GetInputConstructorValue("Value",loader)

             try{
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({value:Value["updated"]})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Restore cookies " + Value["original"], BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}
            
          }else if(State == "httpclientsavecookies")
          {

            var Save = this.$el.find("#Save").val().toUpperCase();

            if(Save.length == 0)
            {
              Invalid("Variable is empty");
              return;
            }
            
             try{
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({variable:"VAR_" + Save})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Save cookies to " + Save + " variable", BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}

          }else if(State == "httpclientclearheader")
          {

             try{
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Clear http headers" , BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}
            
          }else if(State == "httpclientget")
          {
            var Value = GetInputConstructorValue("Value",loader)
            var follow = $("#Check").is(':checked')

            if(Value["original"].length <= 0)
            {
              Invalid("Url is empty");
              return;
            }
            
             try{
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({follow:follow,value:Value["updated"]})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Get " + Value["original"], BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}
          
            
          }else if(State == "httpclientpost")
          {
            var Value = GetInputConstructorValue("Value",loader)
            var follow = $("#Check").is(':checked')
            var multipart = $("#CheckSecond").is(':checked')
            
            var PostData = $("#PostData").val()
            

            if(Value["original"].length <= 0)
            {
              Invalid("Url is empty");
              return;
            }

            if(!multipart)
            {
              multipart = "{\"content-type\" : \"urlencode\"}"
            }else
              multipart = "{}"


            params = "{" + PostData + "}"
            
             try{
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({follow:follow,value:Value["updated"],multipart:multipart,params:params})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Post " + Value["original"], BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}
          
            
          }else if(State == "parseline")
          {
            var Value = GetInputConstructorValue("Value",loader)
            var List = $("#VariablesList").val().toUpperCase()
            
            if(Value["original"].length <= 0)
            {
              Invalid("Value is empty");
              return;
            }

            if(List.length <= 0)
            {
              Invalid("Variables list is empty");
              return;
            }

            List = List.replace(/\s/g,"")
            List = List.split(",")
            List = _.compact(List);
            if(List.length > 0)
            {
              /*List[0] = List[0].replace(/[\\[\\]]/g,"")
              List[List.length - 1] = List[List.length - 1].replace(/[\\[\\]]/g,"")*/
            }else
            {
              Invalid("Variables list is empty");
              return; 
            }

             try{
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({list:List,value:Value["updated"]})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Split line " + Value["original"], BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}
          
            
          }else if(State == "httpclientproxy")
          {
              var ProxyText = GetInputConstructorValue("ProxyText",loader)
              var ProxyType = $("#ProxyType").val()
              var ProxyLogin = GetInputConstructorValue("ProxyLogin",loader)
              if(ProxyLogin["updated"] == "")
                ProxyLogin["updated"] = '""'
              var ProxyPassword = GetInputConstructorValue("ProxyPassword",loader)
              if(ProxyPassword["updated"] == "")
                ProxyPassword["updated"] = '""'
              var IsEmptyProxy = false
              if(ProxyText["updated"] == "")
              {
                ProxyText["updated"] = '""'
                IsEmptyProxy = true
              }

              try{
                var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({ProxyText:ProxyText["updated"], ProxyType:ProxyType,ProxyLogin:ProxyLogin["updated"],ProxyPassword:ProxyPassword["updated"]})
                code = Normalize(code,0)
                var text = "Http client proxy " + ProxyText["original"]
                if(IsEmptyProxy)
                  text = "Clear http client proxy"
                BrowserAutomationStudio_Append(text, BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
              }catch(e){}


          }
          else if(State == "httpclientreset")
          {
             try{
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Reset http client", BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}
          }else if(State == "solverfailed")
          {
             try{
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Captcha Failed", BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}
          }
          else if(State == "httpclientdownload")
          {
            var Value = GetInputConstructorValue("Value",loader)
            var File = GetInputConstructorValue("File",loader)


            if(Value["original"].length <= 0)
            {
              Invalid("Url is empty");
              return;
            }
            if(File["original"].length <= 0)
            {
              Invalid("File is empty");
              return;
            }
            
             try{
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({file:File["updated"],value:Value["updated"]})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Download " + Value["original"], BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}
          
            
          }else if(State == "emailpull")
          {

            var Save = this.$el.find("#Save").val().toUpperCase();
            var Value = GetInputConstructorValue("Value", loader);
            
            var List = $("#VariablesList").val().toUpperCase()
            List = List.replace(/\s/g,"")
            List = List.split(",")
            List = _.compact(List);

            if(Save.length == 0)
            {
              Invalid("Variable is empty");
              return;
            }
            if(Value["original"].length == 0)
            {
              Invalid("Eamil id is empty");
              return;
            }
             try{
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({link_list:List,variable:"VAR_" + Save,value: Value["updated"]})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Pull message with to " + Save + " variable", BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}

          }else if(State == "emailsearchfirst")
          {
            var Sender = GetInputConstructorValue("Sender",loader)
            var Subject = GetInputConstructorValue("Subject",loader)
            var Body = GetInputConstructorValue("Body",loader)
            var Save = this.$el.find("#Save").val().toUpperCase();

            var List = $("#VariablesList").val().toUpperCase()
            List = List.replace(/\s/g,"")
            List = List.split(",")
            List = _.compact(List);


            if(Sender["original"].length <= 0)
            {
              Sender["updated"] = '""';
            }
            if(Subject["original"].length <= 0)
            {
              Subject["updated"] = '""';
            }
            if(Body["original"].length <= 0)
            {
              Body["updated"] = '""';
            }
            
             try{
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({link_list:List,variable:"VAR_" + Save,sender:Sender["updated"],subject:Subject["updated"],body:Body["updated"]})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Search in mailbox and save to " + Save, BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}
          
            
          }else if(State == "emailsearchall")
          {
            var Sender = GetInputConstructorValue("Sender",loader)
            var Subject = GetInputConstructorValue("Subject",loader)
            var Body = GetInputConstructorValue("Body",loader)
            var Save = this.$el.find("#Save").val().toUpperCase();


            if(Sender["original"].length <= 0)
            {
              Sender["updated"] = '""';
            }
            if(Subject["original"].length <= 0)
            {
              Subject["updated"] = '""';
            }
            if(Body["original"].length <= 0)
            {
              Body["updated"] = '""';
            }
            
             try{
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({variable:"VAR_" + Save,sender:Sender["updated"],subject:Subject["updated"],body:Body["updated"]})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Search all in mailbox and save to " + Save, BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}
          
            
          }else if(State == "emailsettings")
          {
            var Host = GetInputConstructorValue("Host",loader)
            var Port = GetInputConstructorValue("Port",loader)
            var Username = GetInputConstructorValue("Username",loader)
            var Password = GetInputConstructorValue("Password",loader)
            var Inbox = GetInputConstructorValue("Inbox",loader)
            var Secure = $("#Select").val()

            if(Host["original"].length <= 0)
            {
              Invalid("Host is empty");
              return;
            }
            if(Port["original"].length <= 0)
            {
              Invalid("Port is empty");
              return;
            }
            if(Inbox["original"].length <= 0)
            {
              Invalid("Inbox is empty");
              return;
            }
            if(Username["original"].length <= 0)
            {
              Username["updated"] = '""';
            }
            if(Password["original"].length <= 0)
            {
              Password["updated"] = '""';
            }
             try{
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({host:Host["updated"], username:Username["updated"], password: Password["updated"], port:Port["updated"], encryption:"\"" + je(Secure) + "\"", inbox:Inbox["updated"]})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Setup imap" , BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}
          }else if(State == "emaillength")
          {
            var Save = this.$el.find("#Save").val().toUpperCase();

            if(Save.length == 0)
            {
              Invalid("Variable is empty");
              return;
            }
             try{
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({variable:"VAR_" + Save})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Get email length to " + Save + " variable", BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}
            
          }else if(State == "globalset")
          {
            var Name = GetInputConstructorValue("Name",loader)
            var Value = GetInputConstructorValue("Value",loader)
            var Group = GetInputConstructorValue("Group",loader)

            if(Name["original"].length <= 0)
            {
              Invalid("Key is empty");
              return;
            }
            if(Value["original"].length <= 0)
            {
              Invalid("Value is empty");
              return;
            }
            if(Group["original"].length <= 0)
            {
              Invalid("Group is empty");
              return;
            }
             try{
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({key:Name["updated"],value:Value["updated"],group:Group["updated"]})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Global set " + Group["original"] + ":" + Name["original"], BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}
          }else if(State == "globalget")
          {

            var Save = this.$el.find("#Save").val().toUpperCase();
            var Name = GetInputConstructorValue("Name", loader);
            var Group = GetInputConstructorValue("Group",loader)

            if(Save.length == 0)
            {
              Invalid("Variable is empty");
              return;
            }
            if(Name["original"].length == 0)
            {
              Invalid("Key is empty");
              return;
            }
            if(Group["original"].length <= 0)
            {
              Invalid("Group is empty");
              return;
            }
             try{
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({variable:"VAR_" + Save,group: Group["updated"],key: Name["updated"]})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Global get " + Group["original"] + ":" + Name["original"], BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}

          }else if(State == "base64")
          {
            var Save = this.$el.find("#Save").val().toUpperCase();
            var Value = GetInputConstructorValue("Value", loader);
            var encode = $("#Select").val() == "encode"

            if(Save.length == 0)
            {
              Invalid("Variable is empty");
              return;
            }
            if(Value["original"].length == 0)
            {
              Invalid("Data is empty");
              return;
            }
             try{
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({variable:"VAR_" + Save,value: Value["updated"], encode: encode})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Base64 encode decode to " + Save + " variable", BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}

          }else if(State == "result")
          {
            var Value = GetInputConstructorValue("Value",loader)
            var num = $("#Select").val()

            if(Value["original"].length <= 0)
            {
              Invalid("Data is empty");
              return;
            }
             try{
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({number:parseInt(num)-1,value:Value["updated"]})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Save result " + Value["original"] , BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}
            
          }else if(State == "cachemaskallow")
          {
            var Value = GetInputConstructorValue("Value",loader)

            if(Value["original"].length <= 0)
            {
              Invalid("Mask is empty");
              return;
            }
            
             try{
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({value:Value["updated"]})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Cache allow " + Value["original"] , BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}
          }else if(State == "cachemaskdeny")
          {
            var Value = GetInputConstructorValue("Value",loader)

            if(Value["original"].length <= 0)
            {
              Invalid("Mask is empty");
              return;
            }
            
             try{
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({value:Value["updated"]})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Cache deny " + Value["original"] , BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}
          }else if(State == "requestmaskallow")
          {
            var Value = GetInputConstructorValue("Value",loader)

            if(Value["original"].length <= 0)
            {
              Invalid("Mask is empty");
              return;
            }
            
             try{
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({value:Value["updated"]})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Request allow " + Value["original"] , BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}
          }else if(State == "requestmaskdeny")
          {
            var Value = GetInputConstructorValue("Value",loader)

            if(Value["original"].length <= 0)
            {
              Invalid("Mask is empty");
              return;
            }
            
             try{
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({value:Value["updated"]})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Request deny " + Value["original"] , BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}
          }else if(State == "cleardata")
          {
             try{
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Clear cached data", BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}
          }else if(State == "clearmasks")
          {
             try{
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Clear masks", BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}
          }else if(State == "getstatus")
          {
            var Value = GetInputConstructorValue("Value",loader)
            var Save = this.$el.find("#Save").val().toUpperCase();

            if(Value["original"].length <= 0)
            {
              Invalid("Mask is empty");
              return;
            }
            if(Save.length == 0)
            {
              Invalid("Variable is empty");
              return;
            }
            
             try{
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({variable:"VAR_" + Save,value:Value["updated"]})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Get status of " + Value["original"] , BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}
          }else if(State == "isloaded")
          {
            var Value = GetInputConstructorValue("Value",loader)
            var Save = this.$el.find("#Save").val().toUpperCase();


            if(Value["original"].length <= 0)
            {
              Invalid("Mask is empty");
              return;
            }
            if(Save.length == 0)
            {
              Invalid("Variable is empty");
              return;
            }
            
             try{
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({variable:"VAR_" + Save,value:Value["updated"]})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Is loaded " + Value["original"] , BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}
          }else if(State == "getfromcache")
          {
            var Value = GetInputConstructorValue("Value",loader)
            var Save = this.$el.find("#Save").val().toUpperCase();

            if(Value["original"].length <= 0)
            {
              Invalid("Mask is empty");
              return;
            }
            if(Save.length == 0)
            {
              Invalid("Variable is empty");
              return;
            }

            var base64 = $("#Check").is(':checked')
            
             try{
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({variable:"VAR_" + Save,value:Value["updated"],base64:base64})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Get from cache " + Value["original"] , BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}
          }else if(State == "html")
          {
            var Save = this.$el.find("#Save").val().toUpperCase();

            if(Save.length == 0)
            {
              Invalid("Variable is empty");
              return;
            }
            
             try{
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({variable:"VAR_" + Save})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Save source to " + Save + " variable", BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}

          }else if(State == "getcookiesforurl")
          {

            var Save = this.$el.find("#Save").val().toUpperCase();
            var Value = GetInputConstructorValue("Value", loader);
            if(Save.length == 0)
            {
              Invalid("Variable is empty");
              return;
            }
            if(Value["original"].length == 0)
            {
              Invalid("Url is empty");
              return;
            }
             try{
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({variable:"VAR_" + Save,value: Value["updated"]})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Save cookies for url to " + Save + " variable", BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}

          }else if(State == "restorecookies")
          {
            var Value = GetInputConstructorValue("Value",loader)

            if(Value["updated"].length <= 0)
            {
              Value["updated"] = "\"\""
            }

             try{
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({value:Value["updated"]})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Restore cookies from " + Value["original"], BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}
            
          }else if(State == "savecookies")
          {
            var Save = this.$el.find("#Save").val().toUpperCase();
            if(Save.length == 0)
            {
              Invalid("Variable is empty");
              return;
            }
            
             try{
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({variable:"VAR_" + Save})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Save cookies to " + Save + " variable", BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}

          }else if(State == "openfile")
          {
            var Value = GetInputConstructorValue("Value",loader)

            if(Value["original"].length <= 0)
            {
              Invalid("File is empty");
              return;
            }

             try{
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({value:Value["updated"]})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Set open file " + Value["original"], BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}
            
          }else if(State == "promptresult")
          {
            var Value = GetInputConstructorValue("Value",loader)

            if(Value["original"].length <= 0)
            {
              Invalid("Value is empty");
              return;
            }

             try{
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({value:Value["updated"]})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Prompt result " + Value["original"], BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}
            
          }else if(State == "httpauth")
          {
            var Login = GetInputConstructorValue("Login",loader)
            var Password = GetInputConstructorValue("Password",loader)
            

            if(Login["original"].length <= 0)
            {
              Invalid("Login is empty");
              return;
            }

            if(Password["original"].length <= 0)
            {
              Invalid("Password is empty");
              return;
            }

             try{
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({login:Login["updated"],password:Password["updated"]})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Http Auth " + Login["original"] + ":" + Password["original"], BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}
            
          }else if(State == "javascript")
          {
            var Save = this.$el.find("#Save").val().toUpperCase();
            var Value = GetInputConstructorValue("Value", loader);

            if(Save.length == 0)
            {
              Invalid("Variable is empty");
              return;
            }
            if(Value["original"].length == 0)
            {
              Invalid("Javascript is empty");
              return;
            }
             try{
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({variable:"VAR_" + Save,value: Value["updated"]})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Execute javascript and save to " + Save + " variable", BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}

          }else if(State == "reset")
          {
             try{
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Reset all browser data", BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}

          }else if(State == "solvecaptcha")
          {
            
            var Method = GetInputConstructorValue("Method", loader);
            var Save = this.$el.find("#Save").val().toUpperCase();
            var Value = GetInputConstructorValue("Value", loader);
            var Antigate = GetInputConstructorValue("Antigate", loader);
            var Dbc = GetInputConstructorValue("Dbc", loader);

            if(Save.length == 0)
            {
              Invalid("Variable is empty");
              return;
            }
            if(Value["original"].length == 0)
            {
              Invalid("Captcha is empty");
              return;
            }
            if(Method["original"].length == 0)
            {
              Invalid("Method is empty");
              return;
            }

             try{
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({variable:"VAR_" + Save,value: Value["updated"],method: Method["updated"], antigate: Antigate["updated"], dbc: Dbc["updated"]})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Solve captcha and save to " + Save + " variable", BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}

          }else if(State == "setheader")
          {
            var Name = GetInputConstructorValue("Name",loader)
            var Value = GetInputConstructorValue("Value",loader)

            if(Name["original"].length <= 0)
            {
              Invalid("Name is empty");
              return;
            }

            
             try{
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({name:Name["updated"],value:Value["updated"]})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Set " + Name["original"] + " header" , BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}
          
            
          }else if(State == "custom")
          {
            var val = GetInputConstructorValue("Code",loader)

            if(val["original"].length > 0)
            {
               try{
                var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({code:val["updated"]})
                code = Normalize(code,0)
                BrowserAutomationStudio_Append("Execute " + val["original"].substr(0,30).split(/(?:\r\n|\r|\n)/)[0], BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
              }catch(e)
              {}
            }else
            {
              Invalid("Code is empty");
              return;
            }
          }else if(State == "break")
          {
            var val = GetInputConstructorValue("BreakDepth",loader)


             try{
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({depth:val["updated"]})

              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Break " + val["original"], BrowserAutomationStudio_SaveControls() + code, 1, false);

            }catch(e)
            {}

          }else if(State == "continue")
          {
             try{
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({})

              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Continue", BrowserAutomationStudio_SaveControls() + code, 1, false);

            }catch(e)
            {}

          }else if(State == "success")
          {
             try{
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({})

              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Success", BrowserAutomationStudio_SaveControls() + code, 1, false);

            }catch(e)
            {}

          }else if(State == "fail")
          {
            var val = GetInputConstructorValue("FailMessage",loader)


             try{
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({message:val["updated"]})

              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Fail " + val["original"], BrowserAutomationStudio_SaveControls() + code, 1, false);

            }catch(e)
            {}

          }else if(State == "sleep")
          {
            if($("#sleeprandom").is(':checked'))
            {
              var from = GetInputConstructorValue("sleepfrom",loader)
              var to = GetInputConstructorValue("sleepto",loader)
              if(from["original"].length <= 0)
              {
                Invalid("Sleep from time is empty");
                return;
              }

              if(to["original"].length <= 0)
              {
                Invalid("Sleep to time is empty");
                return;
              }


              try{
                var code = loader.GetAdditionalData() + _.template($('#' + State + "_fromto_code").html())({from:from["updated"], to:to["updated"]})
                code = Normalize(code,0)
                BrowserAutomationStudio_Append("Sleep from " + from["original"] + " to " + to["original"], BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
              }catch(e){}
            }else
            {
              var t = GetInputConstructorValue("sleepfromto",loader)

              if(t["original"].length <= 0)
              {
                Invalid("Sleep time is empty");
                return;
              }

              try{
                var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({t:t["updated"]})
                code = Normalize(code,0)
                BrowserAutomationStudio_Append("Sleep " + t["original"], BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
              }catch(e){}
            }

          }else if(State == "proxy")
          {
              var ProxyText = GetInputConstructorValue("ProxyText",loader)
              var ProxyType = $("#ProxyType").val()
              var ProxyLogin = GetInputConstructorValue("ProxyLogin",loader)
              if(ProxyLogin["updated"] == "")
                ProxyLogin["updated"] = '""'
              var ProxyPassword = GetInputConstructorValue("ProxyPassword",loader)
              if(ProxyPassword["updated"] == "")
                ProxyPassword["updated"] = '""'
              var IsEmptyProxy = false
              if(ProxyText["updated"] == "")
              {
                ProxyText["updated"] = '""'
                IsEmptyProxy = true
              }
              /*if(ProxyText["original"].length <= 0)
              {
                Invalid("Proxy is empty");
                return;
              }*/

              try{
                var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({ProxyText:ProxyText["updated"], ProxyType:ProxyType,ProxyLogin:ProxyLogin["updated"],ProxyPassword:ProxyPassword["updated"]})
                code = Normalize(code,0)
                var text = "Proxy " + ProxyText["original"]
                if(IsEmptyProxy)
                  text = "Clear proxy"
                BrowserAutomationStudio_Append(text, BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
              }catch(e){}


          }else if(State == "emailproxy")
          {
              var ProxyText = GetInputConstructorValue("ProxyText",loader)
              var ProxyType = $("#ProxyType").val()
              var ProxyLogin = GetInputConstructorValue("ProxyLogin",loader)
              if(ProxyLogin["updated"] == "")
                ProxyLogin["updated"] = '""'
              var ProxyPassword = GetInputConstructorValue("ProxyPassword",loader)
              if(ProxyPassword["updated"] == "")
                ProxyPassword["updated"] = '""'
              var IsEmptyProxy = false
              if(ProxyText["updated"] == "")
              {
                ProxyText["updated"] = '""'
                IsEmptyProxy = true
              }
              /*if(ProxyText["original"].length <= 0)
              {
                Invalid("Proxy is empty");
                return;
              }*/

              try{
                var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({ProxyText:ProxyText["updated"], ProxyType:ProxyType,ProxyLogin:ProxyLogin["updated"],ProxyPassword:ProxyPassword["updated"]})
                code = Normalize(code,0)
                var text = "Email proxy " + ProxyText["original"]
                if(IsEmptyProxy)
                  text = "Clear email proxy"
                BrowserAutomationStudio_Append(text, BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
              }catch(e){}


          }else if(State == "waitload" || State == "waiturl" || State == "waitcontent" || State == "waitcss")
          {
            var val = GetInputConstructorValue("Wait",loader)

            if(val["original"].length > 0)
            {
               try{
                var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({waiter:val["updated"]})
                code = Normalize(code,0)
                BrowserAutomationStudio_Append("Wait " + val["original"], BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
              }catch(e)
              {}
            }else
            {
              Invalid("Waiter is empty");
              return;
            }
          }else if(State == "if")
          {
            var val = GetInputConstructorValue("IfExpression",loader)
            var ElseEnabled = $("#IfElse").is(":checked")
            if(val["original"].length > 0)
            {

               try{
                if(!ElseEnabled)
                {
                  var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({expression:val["updated"]})
                  code = Normalize(code,0)
                  BrowserAutomationStudio_Append("If " + val["original"], BrowserAutomationStudio_SaveControls() + code, 1, false);
                }else
                {
                  var code = loader.GetAdditionalData() + "\n" + "IF_ELSE_EXPRESSION = " + val["updated"] + ";\n"

                  code += _.template($('#' + State + "_code").html())({expression:"IF_ELSE_EXPRESSION"})
                  code = Normalize(code,0)
                  BrowserAutomationStudio_Append("If " + val["original"], BrowserAutomationStudio_SaveControls() + code, 1, false);

                  if(!_GobalModel.get("isedit"))
                  {
                    code = _.template($('#' + State + "_code").html())({expression:"!IF_ELSE_EXPRESSION"})
                    code = Normalize(code,0)
                    BrowserAutomationStudio_Append("Else", code, 1, false);
                  }
                }
              }catch(e)
              {}
            }else
            {
              Invalid("Expression is empty");
              return;
            }
          }else if(State == "while")
          {
            var val = GetInputConstructorValue("WhileExpression",loader)
            if(val["original"].length > 0)
            {
               try{
                var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({expression:val["updated"],additional:loader.GetAdditionalData()})
                code = Normalize(code,0)
                BrowserAutomationStudio_Append("While " + val["original"], BrowserAutomationStudio_SaveControls() + code, 1, false);
              }catch(e)
              {}
            }else
            {
              Invalid("Expression is empty");
              return;
            }
          }else if(State == "for")
          {
            var from = GetInputConstructorValue("ForFrom",loader)
            var to = GetInputConstructorValue("ForTo",loader)
            if(from["original"].length == 0)
            {
              Invalid("From is empty");
              return;
            }
            if(to["original"].length == 0)
            {
              Invalid("To is empty");
              return;
            }
             try{
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({expression_from:from["updated"],expression_to:to["updated"]})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("For " + from["original"] + " : " + to["original"], BrowserAutomationStudio_SaveControls() + code, 1, false);
            }catch(e)
            {}
          }else if(State == "foreach")
          {
            var ForArray = GetInputConstructorValue("ForArray",loader)
            if(ForArray["original"].length == 0)
            {
              Invalid("Array is empty");
              return;
            }
             try{
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({for_array:ForArray["updated"]})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Foreach " + ForArray["original"], BrowserAutomationStudio_SaveControls() + code, 1, false);
            }catch(e)
            {}
          }else if(State == "resize")
          {
            var width = GetInputConstructorValue("ResizeX",loader)
            var height = GetInputConstructorValue("ResizeY",loader)

            if(width["original"].length == 0)
            {
              Invalid("Width is empty");
              return;
            }


            if(height["original"].length == 0)
            {
              Invalid("Height is empty");
              return;
            }

             try{
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({width:width["updated"],height:height["updated"]})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Resize " + width["original"] + " : " + height["original"], BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}
          }else if(State == "type")
          {
            var TypeData = GetInputConstructorValue("TypeData",loader);
            var TypeInterval = GetInputConstructorValue("TypeInterval",loader);

            if(TypeInterval["original"].length == 0)
            {
              Invalid("interval is empty");
              return;
            }
            if(TypeData["original"].length == 0)
            {
              Invalid("Type data is empty");
              return;
            }

            try{
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({text:TypeData["updated"],interval:TypeInterval["updated"]})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Type " + TypeData["original"], BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}

          }else if(State == "typeelement")
          {
            var TypeData = GetInputConstructorValue("TypeData",loader);
            var TypeInterval = GetInputConstructorValue("TypeInterval",loader);

            if(TypeInterval["original"].length == 0)
            {
              Invalid("interval is empty");
              return;
            }
            if(TypeData["original"].length == 0)
            {
              Invalid("Type data is empty");
              return;
            }

            try{
              var path = GetPath(loader)
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({text:TypeData["updated"],interval:TypeInterval["updated"],path: path["path"],waiter: path["waiter"]})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Type " + TypeData["original"], BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}

          }else if(State == "set")
          {
            var Value = GetInputConstructorValue("Value",loader);


            if(Value["original"].length == 0)
            {
              Invalid("Set value is empty");
              return;
            }

            try{
              var path = GetPath(loader)
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({set:Value["updated"],path: path["path"],waiter: path["waiter"]})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Set " + Value["original"], BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}

          }else if(State == "set_integer")
          {
            var Value = GetInputConstructorValue("Value",loader);


            if(Value["original"].length == 0)
            {
              Invalid("Set value is empty");
              return;
            }

            try{
              var path = GetPath(loader)
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({set:Value["updated"],path: path["path"],waiter: path["waiter"]})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Set integer " + Value["original"], BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}

          }else if(State == "set_random")
          {

            try{
              var path = GetPath(loader)
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({path: path["path"],waiter: path["waiter"]})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Set random", BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}

          }
          _MACRO_INSERT_SELECT_
          else if(State == "log")
          {
            var val = GetInputConstructorValue("LogText", loader)

            if(val["original"].length > 0)
            {
               try{
                var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({text:val["updated"]})
                code = Normalize(code,0)
                BrowserAutomationStudio_Append("Log " + val["original"], BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
              }catch(e)
              {}
            }else
            {
              Invalid("Log data is empty");
              return;
            }
          }else if(State == "timeout")
          {
            var val = GetInputConstructorValue("Value", loader)
            var isgeneral = this.$el.find("#Type").val().toUpperCase() == "GENERAL";

            if(val["original"].length > 0)
            {
               try{
                var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({timeout:val["updated"], isgeneral: isgeneral})
                code = Normalize(code,0)
                BrowserAutomationStudio_Append("Set Timeout " + val["original"], BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
              }catch(e)
              {}
            }else
            {
              Invalid("Value empty");
              return;
            }
          }else if(State == "url")
          {
            var Variable = this.$el.find("#SaveUrl").val().toUpperCase();

            if(Variable.length > 0)
            {
               try{
                var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({variable:"VAR_" + Variable})
                code = Normalize(code,0)
                BrowserAutomationStudio_Append("Save current url to " + Variable, BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
              }catch(e)
              {}
            }else
            {
              Invalid("Variable is empty");
              return;
            }
          }else if(State == "executefunction")
          {
            var FunctionName = $("#FunctionName").val();

            if(FunctionName.length > 0)
            {
               try{
                var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({name:FunctionName})
                code = Normalize(code,0)
                BrowserAutomationStudio_Append("Call " + FunctionName, BrowserAutomationStudio_SaveControls() + code, 1, false);
              }catch(e)
              {}
            }else
            {
              Invalid("Function is empty");
              return;
            }
          }else if(State == "setvariable")
          {
            var VariableName = this.$el.find("#SetVariableName").val().toUpperCase();
            var VariableValue = GetInputConstructorValue("SetVariableValue", loader)


            if(VariableName.length == 0)
            {
              Invalid("Variable name is empty");
              return;
            }

            if(VariableValue["original"].length == 0)
            {
              Invalid("Variable value is empty");
              return;
            }
             try{
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({variable_name:"VAR_" + VariableName,variable_value:VariableValue["updated"]})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Set " + VariableName + " to " + VariableValue["original"], BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}

          }else if(State == "xml")
          {
            var Variable = this.$el.find("#SaveXml").val().toUpperCase();

            if(Variable.length > 0)
            {
               try{
                var path = GetPath(loader)
                var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({variable:"VAR_" + Variable,path: path["path"],waiter: path["waiter"]})
                code = Normalize(code,0)
                BrowserAutomationStudio_Append("Save element xml to " + Variable + " variable", BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
              }catch(e)
              {}
            }else
            {
              Invalid("Variable is empty");
              return;
            }
          }else if(State == "exist")
          {
            var Variable = this.$el.find("#Save").val().toUpperCase();
            var CheckIsvisible = $("#Check").is(':checked')

            if(Variable.length > 0)
            {
               try{
                var path = GetPath(loader)
                var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({variable:"VAR_" + Variable,path: path["path"],waiter: path["waiter"], isvisible: CheckIsvisible})
                code = Normalize(code,0)
                BrowserAutomationStudio_Append("Check if exists, save to " + Variable + " variable", BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
              }catch(e)
              {}
            }else
            {
              Invalid("Variable is empty");
              return;
            }
          }else if(State == "clickelement")
          {
             try{
              var path = GetPath(loader)
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({path: path["path"],waiter: path["waiter"]})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Click on " + path["raw"], BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}
          }else if(State == "check")
          {
             try{
              var path = GetPath(loader)
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({path: path["path"],waiter: path["waiter"]})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Check " + path["raw"], BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}
          }else if(State == "focus")
          {
             try{
              var path = GetPath(loader)
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({path: path["path"],waiter: path["waiter"]})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Scroll to " + path["raw"], BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}
          }else if(State == "moveelement")
          {
             try{
              var path = GetPath(loader)
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({path: path["path"],waiter: path["waiter"]})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Move on " + path["raw"], BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}
          }else if(State == "moveandclickelement")
          {
             try{
              var path = GetPath(loader)
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({path: path["path"],waiter: path["waiter"]})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Move and click on " + path["raw"], BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}
          }else if(State == "clear")
          {
             try{
              var path = GetPath(loader)
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({path: path["path"],waiter: path["waiter"]})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Clear on " + path["raw"], BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}
          }else if(State == "script")
          {
            var Variable = this.$el.find("#SaveScript").val().toUpperCase();
            var Script = GetInputConstructorValue("ScriptValue", loader);
            if(Variable.length == 0)
            {
              Invalid("Variable is empty");
              return;
            }
            if(Script["original"].length == 0)
            {
              Invalid("Script is empty");
              return;
            }

             try{
              var path = GetPath(loader)
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({variable:"VAR_" + Variable,path: path["path"],waiter: path["waiter"],script: Script["updated"]})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Execute javascript and save to " + Variable + " variable", BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}

          }else if(State == "captcha")
          {
            var Variable = this.$el.find("#Save").val().toUpperCase();
            var Method = GetInputConstructorValue("Method", loader);
            var Antigate = GetInputConstructorValue("Antigate", loader);
            var Dbc = GetInputConstructorValue("Dbc", loader);
            if(Variable.length == 0)
            {
              Invalid("Variable is empty");
              return;
            }
            if(Method["original"].length == 0)
            {
              Invalid("Method is empty");
              return;
            }

             try{

              var path = GetPath(loader)
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({variable:"VAR_" + Variable,path: path["path"],waiter: path["waiter"],method: Method["updated"], antigate: Antigate["updated"], dbc: Dbc["updated"]})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Solve captcha and save to " + Variable + " variable", BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}

          }else if(State == "attr")
          {

            var Save = this.$el.find("#Save").val().toUpperCase();
            var Value = GetInputConstructorValue("Value", loader);
            if(Save.length == 0)
            {
              Invalid("Variable is empty");
              return;
            }
            if(Value["original"].length == 0)
            {
              Invalid("Attr is empty");
              return;
            }
             try{
              var path = GetPath(loader)
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({variable:"VAR_" + Save,path: path["path"],waiter: path["waiter"],attr: Value["updated"]})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Save attribute to " + Save + " variable", BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}

          }else if(State == "length")
          {
            var Save = this.$el.find("#Save").val().toUpperCase();

            if(Save.length == 0)
            {
              Invalid("Variable is empty");
              return;
            }
             try{
              var path = GetPath(loader,true)
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({variable:"VAR_" + Save,path: path["path"],waiter: path["waiter"]})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Save element count to " + Save + " variable", BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}

          }else if(State == "loopelement")
          {
             try{
              var path = GetPath(loader, true)

              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({path: path["path"],waiter: path["waiter"], querycss: path["querycss"], querymatch: path["querymatch"]})

              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Foreach in " + path["raw"], BrowserAutomationStudio_SaveControls() + code, 1, false);
            }catch(e)
            {}

          }else if(State == "set_attr")
          {
            var Name = GetInputConstructorValue("Name", loader);
            var Value = GetInputConstructorValue("Value", loader);

            if(Name["original"].length == 0)
            {
              Invalid("Name is empty");
              return;
            }
            if(Value["original"].length == 0)
            {
              Invalid("Value is empty");
              return;
            }
             try{
              var path = GetPath(loader)
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({path: path["path"],waiter: path["waiter"],value: Value["updated"],name: Name["updated"]})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Set attribute " + Name["original"] + " to " + Value["original"], BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}

          }else if(State == "style")
          {
            var Variable = this.$el.find("#Save").val().toUpperCase();
            var Value = GetInputConstructorValue("Value", loader);
            if(Variable.length == 0)
            {
              Invalid("Variable is empty");
              return;
            }
            if(Value["original"].length == 0)
            {
              Invalid("Style is empty");
              return;
            }

             try{
              var path = GetPath(loader)
              var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({variable:"VAR_" + Variable,path: path["path"],waiter: path["waiter"],style: Value["updated"]})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Save element style to " + Variable + " variable", BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}

          }else if(State == "text")
          {
            var Variable = this.$el.find("#SaveText").val().toUpperCase();

            if(Variable.length > 0)
            {
               try{
                var path = GetPath(loader)
                var code = loader.GetAdditionalData() + _.template($('#' + State + "_code").html())({variable:"VAR_" + Variable,path: path["path"],waiter: path["waiter"]})
                code = Normalize(code,0)
                BrowserAutomationStudio_Append("Save element text to " + Variable + " variable", BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
              }catch(e)
              {}
            }else
            {
              Invalid("Variable is empty");
              return;
            }
          }else if(State == "click")
          {
            var MoveX = GetInputConstructorValue("ClickX", loader);
            var MoveY = GetInputConstructorValue("ClickY", loader);

            try{
              var code = loader.GetAdditionalData() +  _.template($('#' + State + "_code").html())({x:MoveX["updated"],y:MoveY["updated"]})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Click " + MoveX["original"] + "," + MoveY["original"], BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}
          }else if(State == "move")
          {
            var MoveX = GetInputConstructorValue("MoveX", loader);
            var MoveY = GetInputConstructorValue("MoveY", loader);

            try{
              var code = loader.GetAdditionalData() +  _.template($('#' + State + "_code").html())({x:MoveX["updated"],y:MoveY["updated"]})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Move " + MoveX["original"] + "," + MoveY["original"], BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}

          }else if(State == "scroll")
          {
            var X = GetInputConstructorValue("X", loader);
            var Y = GetInputConstructorValue("Y", loader);

            try{
              var code = loader.GetAdditionalData() +  _.template($('#' + State + "_code").html())({x:X["updated"],y:Y["updated"]})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Scroll to " + X["original"] + "," + Y["original"], BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}

          }else if(State == "renderscreen")
          {
            var X = GetInputConstructorValue("X", loader);
            var Y = GetInputConstructorValue("Y", loader);
            var Width = GetInputConstructorValue("Width", loader);
            var Height = GetInputConstructorValue("Height", loader);
            var Variable = this.$el.find("#Save").val().toUpperCase();
            try{
              var code = loader.GetAdditionalData() +  _.template($('#' + State + "_code").html())({variable:"VAR_" + Variable, x:X["updated"],y:Y["updated"],width:Width["updated"],height:Height["updated"]})

              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Render " + X["original"] + "," + Y["original"]+ "," + Width["original"] + "," + Height["original"], BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}

          }else if(State == "moveandclick")
          {
            var MoveX = GetInputConstructorValue("X", loader);
            var MoveY = GetInputConstructorValue("Y", loader);

            try{
              var code = loader.GetAdditionalData() +  _.template($('#' + State + "_code").html())({x:MoveX["updated"],y:MoveY["updated"]})
              code = Normalize(code,0)
              BrowserAutomationStudio_Append("Move and click " + MoveX["original"] + "," + MoveY["original"], BrowserAutomationStudio_SaveControls() + code, action, DisableIfAdd);
            }catch(e)
            {}
          }else if(State == "threadnumber")
          {
            var ThreadNumber = GetInputConstructorValue("ThreadNumber", loader)["original"];
            if(ThreadNumber.toString().length == 0)
              ThreadNumber = "1"
            try{BrowserAutomationStudio_Append("_threadnumber_", ThreadNumber, action);}catch(e){}
          }else if(State == "successnumber")
          {
            var SuccessNumber = GetInputConstructorValue("SuccessNumber", loader)["original"];
            if(SuccessNumber.toString().length == 0)
              SuccessNumber = "1"
            try{BrowserAutomationStudio_Append("_successnumber_", SuccessNumber.toString(), action);}catch(e){}
          }else if(State == "failnumber")
          {
            var FailNumber = GetInputConstructorValue("FailNumber", loader)["original"];
            if(FailNumber.toString().length == 0)
              FailNumber = "1"
            try{BrowserAutomationStudio_Append("_failnumber_", FailNumber.toString(), action);}catch(e){}
          }

          _Router.navigate("", true);
      },

      initialize: function(){
        this.templates =
        {
          "main" : _.template($('#main').html()),
          "load" : _.template($('#load').html()),
          "type" : _.template($('#type').html()),
          "waitload" : _.template($('#waitload').html()),
          "waiturl" : _.template($('#waiturl').html()),
          "waitcontent" : _.template($('#waitcontent').html()),
          "waitcss" : _.template($('#waitcss').html()),
          "sleep" : _.template($('#sleep').html()),
          "resize" : _.template($('#resize').html()),
          "proxy" : _.template($('#proxy').html()),
          "click" : _.template($('#click').html()),
          "move" : _.template($('#move').html()),
          "moveandclick" : _.template($('#moveandclick').html()),
          "threadnumber" : _.template($('#threadnumber').html()),
          "failnumber" : _.template($('#failnumber').html()),
          "successnumber" : _.template($('#successnumber').html()),
          "log" : _.template($('#log').html()),
          "url" : _.template($('#url').html()),
          "xml" : _.template($('#xml').html()),
          "text" : _.template($('#text').html()),
          "setvariable": _.template($('#setvariable').html()),
          "if": _.template($('#if').html()),
          "while": _.template($('#while').html()),
          "for": _.template($('#for').html()),
          "foreach": _.template($('#foreach').html()),
          "executefunction": _.template($('#executefunction').html()),
          "break": _.template($('#break').html()),
          "continue": _.template($('#continue').html()),
          "fail": _.template($('#fail').html()),
          "success": _.template($('#success').html()),
          "custom": _.template($('#custom').html()),
          "script": _.template($('#script').html()),
          "clickelement": _.template($('#clickelement').html()),
          "moveelement": _.template($('#moveelement').html()),
          "moveandclickelement": _.template($('#moveandclickelement').html()),
          "clear": _.template($('#clear').html()),
          "typeelement": _.template($('#typeelement').html()),
          "exist": _.template($('#exist').html()),
          "style": _.template($('#style').html()),
          "check": _.template($('#check').html()),
          "focus": _.template($('#focus').html()),
          "set": _.template($('#set').html()),
          "set_integer": _.template($('#set_integer').html()),
          "set_random": _.template($('#set_random').html()),
          "attr": _.template($('#attr').html()),
          "set_attr": _.template($('#set_attr').html()),
          "captcha": _.template($('#captcha').html()),
          "length": _.template($('#length').html()),
          "loopelement": _.template($('#loopelement').html()),
          "setheader": _.template($('#setheader').html()),
          "solvecaptcha": _.template($('#solvecaptcha').html()),
          "javascript": _.template($('#javascript').html()),
          "reset": _.template($('#reset').html()),
          "openfile": _.template($('#openfile').html()),
          "getcookiesforurl": _.template($('#getcookiesforurl').html()),
          "savecookies": _.template($('#savecookies').html()),
          "restorecookies": _.template($('#restorecookies').html()),
          "scroll": _.template($('#scroll').html()),
          "html": _.template($('#html').html()),
          "renderscreen": _.template($('#renderscreen').html()),
          "cachemaskallow": _.template($('#cachemaskallow').html()),
          "cachemaskdeny": _.template($('#cachemaskdeny').html()),
          "cachemaskclear": _.template($('#cachemaskclear').html()),
          "requestmaskallow": _.template($('#requestmaskallow').html()),
          "requestmaskdeny": _.template($('#requestmaskdeny').html()),
          "requestmaskclear": _.template($('#requestmaskclear').html()),
          "cleardata": _.template($('#cleardata').html()),
          "clearmasks": _.template($('#clearmasks').html()),
          "getstatus": _.template($('#getstatus').html()),
          "isloaded": _.template($('#isloaded').html()),
          "getfromcache": _.template($('#getfromcache').html()),
          "result": _.template($('#result').html()),
          "base64": _.template($('#base64').html()),
          "globalset": _.template($('#globalset').html()),
          "globalget": _.template($('#globalget').html()),
          "emailsettings": _.template($('#emailsettings').html()),
          "emailproxy": _.template($('#emailproxy').html()),
          "emaillength": _.template($('#emaillength').html()),
          "emailsearchfirst": _.template($('#emailsearchfirst').html()),
          "emailsearchall": _.template($('#emailsearchall').html()),
          "emailpull": _.template($('#emailpull').html()),
          "httpclientproxy": _.template($('#httpclientproxy').html()),
          "httpclientreset": _.template($('#httpclientreset').html()),
          "httpclientdownload": _.template($('#httpclientdownload').html()),
          "httpclientget": _.template($('#httpclientget').html()),
          "httpclientpost": _.template($('#httpclientpost').html()),
          "httpclienturl": _.template($('#httpclienturl').html()),
          "httpclientcontent": _.template($('#httpclientcontent').html()),
          "httpclientstatus": _.template($('#httpclientstatus').html()),
          "httpclientgetheader": _.template($('#httpclientgetheader').html()),
          "httpclientsetheader": _.template($('#httpclientsetheader').html()),
          "httpclientclearheader": _.template($('#httpclientclearheader').html()),
          "httpclientgetcookiesforurl": _.template($('#httpclientgetcookiesforurl').html()),
          "httpclientsavecookies": _.template($('#httpclientsavecookies').html()),
          "httpclientrestorecookies": _.template($('#httpclientrestorecookies').html()),
          "httpclientfailonerror": _.template($('#httpclientfailonerror').html()),
          "httpclientiserror": _.template($('#httpclientiserror').html()),
          "httpclientgeterrorstring": _.template($('#httpclientgeterrorstring').html()),
          "httpclientxpathxml": _.template($('#httpclientxpathxml').html()),
          "httpclientxpathtext": _.template($('#httpclientxpathtext').html()),
          "httpclientxpathcount": _.template($('#httpclientxpathcount').html()),
          "httpclientxpathexists": _.template($('#httpclientxpathexists').html()),
          "parseline": _.template($('#parseline').html()),
          "waitasyncload": _.template($('#waitasyncload').html()),
          "waitelement": _.template($('#waitelement').html()),
          "timeout": _.template($('#timeout').html()),
          "promptresult": _.template($('#promptresult').html()),
          "httpauth": _.template($('#httpauth').html()),
          "solverfailed": _.template($('#solverfailed').html())
          _MACRO_INSERT_TEMPLATES_
        }
        this.model.bind('change', this.render, this);

        try{
          BrowserAutomationStudio_Initialized();
        }catch(e)
        {}
        this.render();
      },

      render: function(){
        $('[data-toggle="tooltip"]').tooltip()
        $("#containerdata").html(this.templates[this.model.get("state")]({data:this.collection.toJSON(),model:this.model.toJSON(),selector:_SelectorModel.toJSON()}))
        $(".variable-input, .function-input").keypress(function(e){
            var charCode = !e.charCode ? e.which : e.charCode;
            var IsGoodchar =  (charCode == ','.charCodeAt(0) && $(e.target).is("[data-append-array]")) || charCode >= 'A'.charCodeAt(0) && charCode <= 'Z'.charCodeAt(0) || charCode >= 'a'.charCodeAt(0) && charCode <= 'z'.charCodeAt(0) || charCode == '_'.charCodeAt(0) || charCode >= '0'.charCodeAt(0) && charCode <= '9'.charCodeAt(0)
            if(!IsGoodchar)
                e.preventDefault();
        })
        this.updatepath()
        tr()


      },

      /*showtooltip: function(e)
      {
        var name = $(e.target).attr("data-name")
        var description = $(e.target).attr("data-description")
        if(typeof(name) != "undefined" && typeof(description) != "undefined")
        {
          $("#tooltip").html("<strong>" + name + "</strong> : " + description)
        }
      },*/


    });

    var Router = Backbone.Router.extend({
        routes: {
            "": "main",
            "!/": "main",
            "!/ok": "ok",
            "!/load": "load",
            "!/timeout": "timeout",
            "!/type": "type",
            "!/waitload": "waitload",
            "!/waiturl": "waiturl",
            "!/waitcontent": "waitcontent",
            "!/waitcss": "waitcss",
            "!/sleep": "sleep",
            "!/resize": "resize",
            "!/proxy": "proxy",
            "!/move": "move",
            "!/click": "click",
            "!/moveandclick": "moveandclick",
            "!/threadnumber": "threadnumber",
            "!/successnumber": "successnumber",
            "!/failnumber": "failnumber",
            "!/log": "log",
            "!/url": "url",
            "!/xml": "xml",
            "!/text": "text",
            "!/setvariable": "setvariable",
            "!/if": "if",
            "!/while": "while",
            "!/for": "for",
            "!/foreach": "foreach",
            "!/executefunction": "executefunction",
            "!/break": "break",
            "!/continue": "continue",
            "!/fail": "fail",
            "!/success": "success",
            "!/custom": "custom",
            "!/script": "script",
            "!/clickelement": "clickelement",
            "!/moveelement": "moveelement",
            "!/moveandclickelement": "moveandclickelement",
            "!/clear": "clear",
            "!/typeelement": "typeelement",
            "!/exist": "exist",
            "!/style": "style",
            "!/check": "check",
            "!/focus": "focus",
            "!/set": "set",
            "!/set_integer": "set_integer",
            "!/set_random": "set_random",
            "!/attr": "attr",
            "!/set_attr": "set_attr",
            "!/captcha": "captcha",
            "!/length": "length",
            "!/loopelement": "loopelement",
            "!/setheader": "setheader",
            "!/solvecaptcha": "solvecaptcha",
            "!/javascript": "javascript",
            "!/reset": "reset",
            "!/openfile": "openfile",
            "!/getcookiesforurl": "getcookiesforurl",
            "!/savecookies": "savecookies",
            "!/restorecookies": "restorecookies",
            "!/scroll": "scroll",
            "!/html": "html",
            "!/renderscreen": "renderscreen",
            "!/cachemaskallow": "cachemaskallow",
            "!/cachemaskdeny": "cachemaskdeny",
            "!/cachemaskclear": "cachemaskclear",
            "!/requestmaskallow": "requestmaskallow",
            "!/requestmaskdeny": "requestmaskdeny",
            "!/requestmaskclear": "requestmaskclear",
            "!/cleardata": "cleardata",
            "!/clearmasks": "clearmasks",
            "!/getstatus": "getstatus",
            "!/isloaded": "isloaded",
            "!/getfromcache": "getfromcache",
            "!/result": "result",
            "!/base64": "base64",
            "!/globalset": "globalset",
            "!/globalget": "globalget",
            "!/emailsettings": "emailsettings",
            "!/emailproxy": "emailproxy",
            "!/emaillength": "emaillength",
            "!/emailsearchfirst": "emailsearchfirst",
            "!/emailsearchall": "emailsearchall",
            "!/emailpull": "emailpull",
            "!/httpclientproxy": "httpclientproxy",
            "!/httpclientreset": "httpclientreset",
            "!/httpclientdownload": "httpclientdownload",
            "!/httpclientget": "httpclientget",
            "!/httpclientpost": "httpclientpost",
            "!/httpclienturl": "httpclienturl",
            "!/httpclientcontent": "httpclientcontent",
            "!/httpclientstatus": "httpclientstatus",
            "!/httpclientgetheader": "httpclientgetheader",
            "!/httpclientsetheader": "httpclientsetheader",
            "!/httpclientclearheader": "httpclientclearheader",
            "!/httpclientgetcookiesforurl": "httpclientgetcookiesforurl",
            "!/httpclientsavecookies": "httpclientsavecookies",
            "!/httpclientrestorecookies": "httpclientrestorecookies",
            "!/httpclientfailonerror": "httpclientfailonerror",
            "!/httpclientiserror": "httpclientiserror",
            "!/httpclientgeterrorstring": "httpclientgeterrorstring",
            "!/httpclientxpathxml": "httpclientxpathxml",
            "!/httpclientxpathtext": "httpclientxpathtext",
            "!/httpclientxpathcount": "httpclientxpathcount",
            "!/httpclientxpathexists": "httpclientxpathexists",
            "!/parseline": "parseline",
            "!/waitasyncload": "waitasyncload",
            "!/waitelement": "waitelement",
            "!/promptresult": "promptresult",
            "!/httpauth": "httpauth",
            "!/solverfailed": "solverfailed"
            _MACRO_INSERT_ROUTER_DEF_
        },

        main: function () {
          _GobalModel.set({ state: "main" });
        },
        timeout: function () {
          _GobalModel.set({ state: "timeout" });
        },
        load: function () {
          _GobalModel.set({ state: "load" });
        },
        type: function () {
          _GobalModel.set({ state: "type" });
        },
        waitload: function () {
          _GobalModel.set({ state: "waitload" });
        },
        waiturl: function () {
          _GobalModel.set({ state: "waiturl" });
        },
        waitcontent: function () {
          _GobalModel.set({ state: "waitcontent" });
        },
        waitcss: function () {
          _GobalModel.set({ state: "waitcss" });
        },
        sleep: function () {
          _GobalModel.set({ state: "sleep" });
        },
        resize: function () {
          _GobalModel.set({ state: "resize" });
        },
        proxy: function () {
          _GobalModel.set({ state: "proxy" });
        },
        move: function () {
          _GobalModel.set({ state: "move" });
        },
        click: function () {
          _GobalModel.set({ state: "click" });
        },
        moveandclick: function () {
          _GobalModel.set({ state: "moveandclick" });
        },
        threadnumber: function () {
          _GobalModel.set({ state: "threadnumber" });
        },
        successnumber: function () {
          _GobalModel.set({ state: "successnumber" });
        },
        failnumber: function () {
          _GobalModel.set({ state: "failnumber" });
        },
        log: function () {
          _GobalModel.set({ state: "log" });
        },
        url: function () {
          _GobalModel.set({ state: "url" });
        },
        xml: function () {
          _GobalModel.set({ state: "xml" });
        },
        text: function () {
          _GobalModel.set({ state: "text" });
        },
        setvariable: function () {
          _GobalModel.set({ state: "setvariable" });
        },
        if: function () {
          _GobalModel.set({ state: "if" });
        },
        while: function () {
          _GobalModel.set({ state: "while" });
        },
        for: function () {
          _GobalModel.set({ state: "for" });
        },
        foreach: function () {
          _GobalModel.set({ state: "foreach" });
        },
        executefunction: function(){
          _GobalModel.set({ state: "executefunction" });
        },
        break: function(){
          _GobalModel.set({ state: "break" });
        },
        continue: function(){
          _GobalModel.set({ state: "continue" });
        },
        success: function(){
          _GobalModel.set({ state: "success" });
        },
        fail: function(){
          _GobalModel.set({ state: "fail" });
        },
        custom: function(){
          _GobalModel.set({ state: "custom" });
        },
        script: function(){
          _GobalModel.set({ state: "script" });
        },
        clickelement: function(){
          _GobalModel.set({ state: "clickelement" });
        },
        moveelement: function(){
          _GobalModel.set({ state: "moveelement" });
        },
        moveandclickelement: function(){
          _GobalModel.set({ state: "moveandclickelement" });
        },
        clear: function(){
          _GobalModel.set({ state: "clear" });
        },
        typeelement: function(){
          _GobalModel.set({ state: "typeelement" });
        },
        exist: function(){
          _GobalModel.set({ state: "exist" });
        },
        style: function(){
          _GobalModel.set({ state: "style" });
        },
        check: function(){
          _GobalModel.set({ state: "check" });
        },
        focus: function(){
          _GobalModel.set({ state: "focus" });
        },
        set: function(){
          _GobalModel.set({ state: "set" });
        },
        set_integer: function(){
          _GobalModel.set({ state: "set_integer" });
        },
        set_random: function(){
          _GobalModel.set({ state: "set_random" });
        },
        attr: function(){
          _GobalModel.set({ state: "attr" });
        },
        set_attr: function(){
          _GobalModel.set({ state: "set_attr" });
        },
        captcha: function(){
          _GobalModel.set({ state: "captcha" });
        },
        length: function(){
          _GobalModel.set({ state: "length" });
        },
        loopelement: function(){
          _GobalModel.set({ state: "loopelement" });
        },
        setheader: function(){
          _GobalModel.set({ state: "setheader" });
        },
        solvecaptcha: function(){
                  _GobalModel.set({ state: "solvecaptcha" });
                },
        javascript: function(){
                  _GobalModel.set({ state: "javascript" });
                },
        reset: function(){
                  _GobalModel.set({ state: "reset" });
                },
        openfile: function(){
                  _GobalModel.set({ state: "openfile" });
                },
        getcookiesforurl: function(){
                  _GobalModel.set({ state: "getcookiesforurl" });
                },
        savecookies: function(){
                  _GobalModel.set({ state: "savecookies" });
                },
        restorecookies: function(){
                  _GobalModel.set({ state: "restorecookies" });
                },
        scroll: function(){
                  _GobalModel.set({ state: "scroll" });
                },
        html: function(){
                  _GobalModel.set({ state: "html" });
                },
        renderscreen: function(){
                  _GobalModel.set({ state: "renderscreen" });
                },
        cachemaskallow: function(){
                  _GobalModel.set({ state: "cachemaskallow" });
                },
        cachemaskdeny: function(){
                  _GobalModel.set({ state: "cachemaskdeny" });
                },
        cachemaskclear: function(){
                  _GobalModel.set({ state: "cachemaskclear" });
                },
        requestmaskallow: function(){
                  _GobalModel.set({ state: "requestmaskallow" });
                },
        requestmaskdeny: function(){
                  _GobalModel.set({ state: "requestmaskdeny" });
                },
        requestmaskclear: function(){
                  _GobalModel.set({ state: "requestmaskclear" });
                },
        cleardata: function(){
                  _GobalModel.set({ state: "cleardata" });
                },
        clearmasks: function(){
                  _GobalModel.set({ state: "clearmasks" });
                },
        getstatus: function(){
                  _GobalModel.set({ state: "getstatus" });
                },
        isloaded: function(){
                  _GobalModel.set({ state: "isloaded" });
                },
        getfromcache: function(){
                  _GobalModel.set({ state: "getfromcache" });
                },
        result: function(){
                  _GobalModel.set({ state: "result" });
                },
        base64: function(){
                  _GobalModel.set({ state: "base64" });
                },
        globalset: function(){
                  _GobalModel.set({ state: "globalset" });
                },
        globalget: function(){
                  _GobalModel.set({ state: "globalget" });
                },
        emailsettings: function(){
                  _GobalModel.set({ state: "emailsettings" });
                },
        emailproxy: function(){
                  _GobalModel.set({ state: "emailproxy" });
                },
        emaillength: function(){
                  _GobalModel.set({ state: "emaillength" });
                },
        emailsearchfirst: function(){
                  _GobalModel.set({ state: "emailsearchfirst" });
                },
        emailsearchall: function(){
                  _GobalModel.set({ state: "emailsearchall" });
                },
        emailpull: function(){
                  _GobalModel.set({ state: "emailpull" });
                },
        httpclientproxy: function(){
                  _GobalModel.set({ state: "httpclientproxy" });
                },
        httpclientreset: function(){
                  _GobalModel.set({ state: "httpclientreset" });
                },
        httpclientdownload: function(){
                  _GobalModel.set({ state: "httpclientdownload" });
                },
        httpclientget: function(){
                  _GobalModel.set({ state: "httpclientget" });
                },
        httpclientpost: function(){
                  _GobalModel.set({ state: "httpclientpost" });
                },
        httpclienturl: function(){
                  _GobalModel.set({ state: "httpclienturl" });
                },
        httpclientcontent: function(){
                  _GobalModel.set({ state: "httpclientcontent" });
                },
        httpclientstatus: function(){
                  _GobalModel.set({ state: "httpclientstatus" });
                },
        httpclientgetheader: function(){
                  _GobalModel.set({ state: "httpclientgetheader" });
                },
        httpclientsetheader: function(){
                  _GobalModel.set({ state: "httpclientsetheader" });
                },
        httpclientclearheader: function(){
                  _GobalModel.set({ state: "httpclientclearheader" });
                },
        httpclientgetcookiesforurl: function(){
                  _GobalModel.set({ state: "httpclientgetcookiesforurl" });
                },
        httpclientsavecookies: function(){
                  _GobalModel.set({ state: "httpclientsavecookies" });
                },
        httpclientrestorecookies: function(){
                  _GobalModel.set({ state: "httpclientrestorecookies" });
                },
        httpclientfailonerror: function(){
                  _GobalModel.set({ state: "httpclientfailonerror" });
                },
        httpclientiserror: function(){
                  _GobalModel.set({ state: "httpclientiserror" });
                },
        httpclientgeterrorstring: function(){
                  _GobalModel.set({ state: "httpclientgeterrorstring" });
                },
        httpclientxpathxml: function(){
                  _GobalModel.set({ state: "httpclientxpathxml" });
                },
        httpclientxpathtext: function(){
                  _GobalModel.set({ state: "httpclientxpathtext" });
                },
        httpclientxpathcount: function(){
                  _GobalModel.set({ state: "httpclientxpathcount" });
                },
        httpclientxpathexists: function(){
                  _GobalModel.set({ state: "httpclientxpathexists" });
                },
        parseline: function(){
                  _GobalModel.set({ state: "parseline" });
                },
        waitasyncload: function(){
                  _GobalModel.set({ state: "waitasyncload" });
                },
        waitelement: function(){
                  _GobalModel.set({ state: "waitelement" });
                },
        promptresult: function(){
                  _GobalModel.set({ state: "promptresult" });
                },
        httpauth: function(){
                  _GobalModel.set({ state: "httpauth" });
                },
        solverfailed: function(){
          _GobalModel.set({ state: "solverfailed" });
        }
        _MACRO_INSERT_ROUTER_FUNC_
    });

    var _Router = new Router();

    var _TaskCollection = new TaskCollection([
                { description: tr("Browser"), type: "group" },
                { name: tr("Load"), description: tr("Load specific url"), ref: "load" },
                { name: tr("Current Url"), description: tr("Get current url"), ref: "url" },
                { name: tr("Page Html"), description: tr("Save page html to variable"), ref: "html" },
                { name: tr("Type"), description: tr("Type text on page. For example, put email in input field"), ref: "type" },
                { name: tr("Resize"), description: tr("Change browser size"), ref: "resize" },
                { name: tr("Proxy"), description: tr("Set proxy"), ref: "proxy" },
                { name: tr("Javascript"), description: tr("Execute javascript"), ref: "javascript" },
                { name: tr("Reset"), description: tr("Clear all browser data"), ref: "reset" },
                { name: tr("Open File Result"), description: tr("Set open file dialog result"), ref: "openfile" },
                { name: tr("Prompt Result"), description: tr("Set prompt result"), ref: "promptresult" },
                { name: tr("Http Auth"), description: tr("Set http auth login and password"), ref: "httpauth" },
                { name: tr("Scroll"), description: tr("Scroll to position"), ref: "scroll" },
                { name: tr("Render"), description: tr("Render screen part to variable as png base64 encoded"), ref: "renderscreen" },
                { name: tr("Solve Captcha"), description: tr("Solve captcha"), ref: "solvecaptcha" },
                { name: tr("Captcha Failed"), description: tr("Captcha Failed"), ref: "solverfailed" },
                { name: tr("Timeout"), description: tr("Set Timeout"), ref: "timeout" },
                { description: tr("Waiters"), type: "group" },
                { name: tr("Wait Url Loaded"), description: tr("Wait until browser will load url"), ref: "waitload" },
                { name: tr("Wait Address Bar"), description: tr("Wait address bar will contain url"), ref: "waiturl" },
                { name: tr("Wait Text"), description: tr("Wait until specific text will be present on page"), ref: "waitcontent" },
                { name: tr("Wait Css"), description: tr("Wait until specific css selector will return non empty result"), ref: "waitcss" },
                { name: tr("Sleep"), description: tr("Sleep for a specific time"), ref: "sleep" },
                { description: tr("Script logic"), type: "group" },
                { name: tr("If"), description: tr("Execute conditional actions"), ref: "if" },
                { name: tr("While"), description: tr("Execute while loop"), ref: "while" },
                { name: tr("For"), description: tr("Execute for loop"), ref: "for" },
                { name: tr("Foreach"), description: tr("Execute foreach loop"), ref: "foreach" },
                { name: tr("Break"), description: tr("Stop loop"), ref: "break" },
                /*{ name: tr("Continue"), description: tr("Start next loop iteration"), ref: "continue" },*/
                { name: tr("Success"), description: tr("Finish script with success result"), ref: "success" },
                { name: tr("Fail"), description: tr("Finish script with fail result"), ref: "fail" },
                { name: tr("Set Variable"), description: tr("Sets or creates variable"), ref: "setvariable" },
                { name: tr("Call Function"), description: tr("Call function"), ref: "executefunction" },
                { description: tr("Tools"), type: "group" },
                { name: tr("Log"), description: tr("Output string to log"), ref: "log" },
                { name: tr("Result"), description: tr("Save result"), ref: "result" },
                { name: tr("Custom"), description: tr("Execute custom code"), ref: "custom" },
                { name: tr("Base64 Encode/Decode"), description: tr("Base64 encode or decode"), ref: "base64" },
                { name: tr("Set Global Variable"), description: tr("Set global variable"), ref: "globalset" },
                { name: tr("Get Global Variable"), description: tr("Get global variable"), ref: "globalget" },
                { name: tr("Parse Line"), description: tr("Parse line like this 'a1:a2:a3' and save to variables"), ref: "parseline" },
                { description: tr("Network"), type: "group" },
                { name: tr("Set Header"), description: tr("Set HTTP Headers, like user agent, accept language, etc"), ref: "setheader" },
                { name: tr("Get Cookies For Url"), description: tr("Get cookies for url"), ref: "getcookiesforurl" },
                { name: tr("Save Cookies"), description: tr("Save all cookies to variable"), ref: "savecookies" },
                { name: tr("Restore Cookies"), description: tr("Restore cookies, which is saved with Save Cookies command"), ref: "restorecookies" },
                { name: tr("Cache Mask Allow"), description: tr("Allow save loaded url content to cache"), ref: "cachemaskallow" },
                { name: tr("Cache Mask Deny"), description: tr("Deny save loaded url content to cache"), ref: "cachemaskdeny" },
                { name: tr("Request Mask Allow"), description: tr("Allow load url, which matching mask"), ref: "requestmaskallow" },
                { name: tr("Request Mask Deny"), description: tr("Deny load url, which matching mask"), ref: "requestmaskdeny" },
                { name: tr("Clear Cached Data"), description: tr("Clear loaded cache data"), ref: "cleardata" },
                { name: tr("Clear Cache Masks"), description: tr("Clear cache masks"), ref: "clearmasks" },
                { name: tr("Get Status"), description: tr("Get url load status"), ref: "getstatus" },
                { name: tr("Is Loaded"), description: tr("Check if url is loaded"), ref: "isloaded" },
                { name: tr("Get Cached Item"), description: tr("Get base64 encoded cached page"), ref: "getfromcache" },
                { description: tr("Email"), type: "group" },
                { name: tr("Configure"), description: tr("Configure email settings"), ref: "emailsettings" },
                { name: tr("Proxy"), description: tr("Configure email proxy"), ref: "emailproxy" },
                { name: tr("Messages Length"), description: tr("Get messages length"), ref: "emaillength" },
                { name: tr("Search First"), description: tr("Search for first message"), ref: "emailsearchfirst" },
                { name: tr("Search All"), description: tr("Search for all messages"), ref: "emailsearchall" },
                { name: tr("Get Message"), description: tr("Pull message"), ref: "emailpull" },
                { description: tr("Script properties"), type: "group" },
                { name: tr("Threads"), description: tr("Set thread number"), ref: "threadnumber" },
                { name: tr("Success Number"), description: tr("Set success number. When script will be executed successfully 'success number' of times, application will stop"), ref: "successnumber" },
                { name: tr("Fail Number"), description: tr("Set fail number. When script will fail 'fail number' of times, application will stop"), ref: "failnumber" },
                { description: tr("Http Client"), type: "group" },
                { name: tr("Proxy"), description: tr("Set proxy for http client"), ref: "httpclientproxy" },
                { name: tr("Reset"), description: tr("Reset http client"), ref: "httpclientreset" },
                { name: tr("Get"), description: tr("Make GET request"), ref: "httpclientget" },
                { name: tr("Post"), description: tr("Make POST request"), ref: "httpclientpost" },
                { name: tr("Download"), description: tr("Download to file"), ref: "httpclientdownload" },
                { name: tr("Current Url"), description: tr("Get http client current url"), ref: "httpclienturl" },
                { name: tr("Content"), description: tr("Get http client request result"), ref: "httpclientcontent" },
                { name: tr("Status"), description: tr("Get http client request status"), ref: "httpclientstatus" },
                { name: tr("Get Header"), description: tr("Get http client header"), ref: "httpclientgetheader" },
                { name: tr("Set Header"), description: tr("Set http client header"), ref: "httpclientsetheader" },
                { name: tr("Clear Headers"), description: tr("Clear http client request headers"), ref: "httpclientclearheader" },
                { name: tr("Get Cookies For Url"), description: tr("Get cookies for url"), ref: "httpclientgetcookiesforurl" },
                { name: tr("Save Cookies"), description: tr("Save all cookies to variable"), ref: "httpclientsavecookies" },
                { name: tr("Restore Cookies"), description: tr("Restore cookies, which is saved with Save Cookies command"), ref: "httpclientrestorecookies" },
                { name: tr("Set Fail On Error"), description: tr("Fail if error during http request"), ref: "httpclientfailonerror" },
                { name: tr("Is Error"), description: tr("Check if error"), ref: "httpclientiserror" },
                { name: tr("Get Error String"), description: tr("Get last error string"), ref: "httpclientgeterrorstring" },
                { name: tr("Xpath Get Xml"), description: tr("Execute xpath query and get result xml"), ref: "httpclientxpathxml" },
                { name: tr("Xpath Get Text"), description: tr("Execute xpath query and get result text"), ref: "httpclientxpathtext" },
                { name: tr("Xpath Get Count"), description: tr("Execute xpath query and get result count"), ref: "httpclientxpathcount" },
                { name: tr("Xpath Get Exists"), description: tr("Execute xpath query and check if exists"), ref: "httpclientxpathexists" }
                _MACRO_INSERT_ACTION_LIST_

            ]);

    var _GobalModel = new GobalModel();

    var _SelectorModel = new SelectorModel();

    var _MainView = new MainView({collection: _TaskCollection, model: _GobalModel});

    var _ResourceCollection = new ResourceCollection();

    var _VariableCollection = new VariableCollection();

    var _FunctionCollection = new FunctionCollection();

    var _ExpressionEditor = null;

    var ToolboxMaximizeCallback = null;

    function BrowserAutomationStudio_MaximizeCallback()
    {
      if(ToolboxMaximizeCallback)
      {
        ToolboxMaximizeCallback();
        ToolboxMaximizeCallback = null
      }
    }

    Backbone.history.start();

    function Invalid(data)
    {
      console.log("Invalid");
      $("#validation").html(data)
      $("#validation").removeClass("text-muted").removeClass("text-danger").addClass("text-danger")
      
    }

    function je(data)
    {
      return data
      .replace(new RegExp("\\\\","g"),"\\u005c")
      .replace(new RegExp("<","g"),"\\u003c")
      .replace(new RegExp(">","g"),"\\u003e")
      .replace(new RegExp("\"","g"),"\\u0022")
      .replace(new RegExp("'","g"),"\\u0027")
      .replace(new RegExp("&","g"),"\\u0026")
    }

    function utf8_to_b64( str ) {
        return window.btoa(unescape(encodeURIComponent( str )));
    }

    function b64_to_utf8( str ) {
        return decodeURIComponent(escape(window.atob( str )));
    }

    function BrowserAutomationStudio_SaveControls()
    {
      var ControlsText = {s:_GobalModel.get("state"),e:$("#executetype .btn-info").attr("data-action")}
      var ControlList = $("*[data-preserve=true]")
      var Elements = []
      var loader = new ResourceLoader();

      for(var i = 0;i<ControlList.length;i++)
      {
        var el = $(ControlList[i])
        var NewElement = {}
        var id = el.attr("data-preserve-id")
        var type = el.attr("data-preserve-type")
        var json = el.attr("data-preserve-json")


        NewElement["id"] = id
        NewElement["type"] = type
        NewElement["json"] = json


        if(type == "constr")
        {
          NewElement["data"] = GetInputConstructorValue(id,loader)["original"]
          NewElement["class"] = $("*[data-selector-id=" + id + "]").html()
        }else if(type == "var")
        {
          NewElement["data"] = $("#" + id).val()
        }else if(type == "select")
        {
          NewElement["data"] = $("#" + id).val()
        }else if(type == "check")
        {
          NewElement["data"] = $("#" + id).prop("checked")
        }else if(type == "text")
        {
          NewElement["data"] =  $("#" + id).val()
        }

        Elements.push(NewElement)
      }
      ControlsText["d"] = Elements
      if($(".path").length>0 || $(".path2").length>0)
      {
        var all = {}
        var json = _SelectorModel.toJSON()
        var current = json["current"]

        
        all["css"] = json["css"]
        all["current"] = current
        all["match"] = json["match"]
        all["at"] = json["mousex"] + ", " + json["mousey"]

        if(current!="none")
          all[current] = $("#selector-input").val()

        ControlsText["p"] = all
      }

      ControlsText = "/*Dat:" + utf8_to_b64(JSON.stringify(ControlsText)) +  "*/\n"
      return ControlsText
    }

    function BrowserAutomationStudio_EditStart(dataraw)
    {
      var data = JSON.parse(b64_to_utf8(dataraw))

      if("p" in data)
      {
        var selector = data["p"]
        _SelectorModel.set("css",selector["css"])
        _SelectorModel.set("match",selector["match"])
        var split = selector["at"].split(",")
        _SelectorModel.set("mousex",split[0].replace(/\s/g, ''))
        _SelectorModel.set("mousey",split[split.length - 1].replace(/\s/g, ''))
        _SelectorModel.set("current",selector["current"])
      }

      _GobalModel.set("isedit",true)
      _GobalModel.set({ state: data["s"] });

      $("#executetype button").removeClass("btn-info")
      $("#executetype button").addClass("btn-default")

      $("#executetype *[data-action=" + data["e"] + "]").removeClass("btn-default").addClass("btn-info")

      for(var i = 0;i<data["d"].length;i++)
      {
        var el = data["d"][i]
        
        var id = el["id"]
        var type = el["type"]
        var _data = el["data"]

        if(type == "constr")
        {
          
          var _class = el["class"]
          $("*[data-preserve-id=" + id + "] a." + _class).click()
          $("*[data-preserve-id=" + id + "]").attr("data-preserve-json",el["json"])
          if(_class == "int")
          {
            $("#" + id + "_number").val(parseInt(_data))
          }else
            $("#" + id).val(_data)

        }else if(type == "check")
        {
          $("#" + id).prop("checked",_data);
        }else
        {
          $("#" + id).val(_data);
        }

      }
    }

    function BrowserAutomationStudio_EditEnd()
    {
      _GobalModel.set("isedit",false)
      _GobalModel.set({ state: "main" });
    }


    function BrowserAutomationStudio_SetResources(resources, additional_resources)
    {
      _ResourceCollection.reset()

      var res = JSON.parse(resources)
      var additional_res = JSON.parse(additional_resources) 

      for(var i = 0;i < res.length;i+=1)
      {
        _ResourceCollection.add({name:res[i]["name"],description:res[i]["description"]})
      }

      for(var i = 0;i < additional_res.length;i+=1)
      {
        _ResourceCollection.add({name:additional_res[i]["name"],description:additional_res[i]["name"]})
      }
    }

    function BrowserAutomationStudio_SetVariables(variables)
    {
      _VariableCollection.reset()
      var res = JSON.parse(variables)
      var added_cycle_index = false
      for(var i = 0;i < res.length;i+=1)
      {
        _VariableCollection.add({name:res[i]["name"]})
        if(res[i]["name"] == "CYCLE_INDEX")
          added_cycle_index = true
      }
      if(!added_cycle_index)
      _VariableCollection.add({name:"CYCLE_INDEX"})
    }

    function BrowserAutomationStudio_SetFunctions(functions)
    {
      _FunctionCollection.reset()
      var res = JSON.parse(functions)

      for(var i = 0;i < res.length;i+=1)
      {
        _FunctionCollection.add({name:res[i]["name"]})
      }
    }

    function GetInputConstructorValue(id, loader)
    {

        var ResTextTypeIsString = $("*[data-selector-id=" + id + "]").html() == "string";
        var ResTextTypeIsInt = $("*[data-selector-id=" + id + "]").html() == "int";

        var ResText;
        if(ResTextTypeIsString)
          ResText = $("#" + id).val();
        else if(ResTextTypeIsInt)
          ResText = $("#" + id + "_number").val();
        else
          ResText = $("#" + id).val();

        loader.SetIsString(ResTextTypeIsString)
        var ResTextUpdated = loader.Resolve(ResText+"");
        if(ResTextUpdated.length == 0)
          ResTextUpdated = "\"\""
        return {"updated" : ResTextUpdated, "original" : ResText}
    }

    function GetPath(loader, need_all)
    {
      var current = _SelectorModel.get("current")
      if(current == "none")
        return {path:"page()",waiter:"",raw:"", querycss: je(_SelectorModel.get("css")), querymatch: je(_SelectorModel.get("match"))}

      var raw_not_escaped = $("#selector-input").val()
      var raw_original = $("#selector-input").val()
      var index = ""

      var index_match = raw_not_escaped.match(/\s*\<\s*([^\>]+)\s*\>\s*$/)
      if(index_match)
      {
        index = index_match[1]
        raw_not_escaped = raw_not_escaped.replace(/\<\s*([^\>]+)\s*\>\s*$/,"")
      }

      loader.SetIsString(true)
      var raw = loader.Resolve(raw_not_escaped+"")

      if(index.length > 0)
      {
        loader.SetIsString(false)
        index = loader.Resolve(index+"")
      }

      if(current == "css")
      {
        var path = "css"

        if(index.length > 0 || typeof(need_all) != "undefined")
          path = "all"

        path += "(" + raw + ")"

        if(index.length > 0)
          path += ".at(" + index + ")"

        return {path:path,waiter:"wait_css(" + raw + ")!",raw:"css " + raw_not_escaped, querycss: je(raw_original), querymatch: je(_SelectorModel.get("match"))}
      }

      if(current == "match")
      {
        var path = "match"

        if(index.length > 0 || typeof(need_all) != "undefined")
          path = "match_all"

        path += "(" + raw + ")"

        if(index.length > 0)
          path += ".at(" + index + ")"

        return {path:path,waiter:"wait_content(" + raw + ")!", raw:"match " + raw_not_escaped, querycss: je(_SelectorModel.get("css")), querymatch: je(raw_original)}
      }

      if(current == "at")
        return {path:"position(" + raw + ")",waiter:"", raw:"position " + raw_not_escaped, querycss: je(_SelectorModel.get("css")), querymatch: je(_SelectorModel.get("match"))}

      return {path:"page()",waiter:"",raw:"", query: "", querycss: je(_SelectorModel.get("css")), querymatch: je(_SelectorModel.get("match"))}
    }

    function InsertAtCaret(areaId,text)
    {
        var txtarea = document.getElementById(areaId);
        var scrollPos = txtarea.scrollTop;
        var strPos = 0;
        var br = ((txtarea.selectionStart || txtarea.selectionStart == '0') ?
            "ff" : (document.selection ? "ie" : false ) );
        if (br == "ie") {
            txtarea.focus();
            var range = document.selection.createRange();
            range.moveStart ('character', -txtarea.value.length);
            strPos = range.text.length;
        }
        else if (br == "ff") strPos = txtarea.selectionStart;

        var front = (txtarea.value).substring(0,strPos);
        var back = (txtarea.value).substring(strPos,txtarea.value.length);
        txtarea.value=front+text+back;
        strPos = strPos + text.length;
        if (br == "ie") {
            txtarea.focus();
            var range = document.selection.createRange();
            range.moveStart ('character', -txtarea.value.length);
            range.moveStart ('character', strPos);
            range.moveEnd ('character', 0);
            range.select();
        }
        else if (br == "ff") {
            txtarea.selectionStart = strPos;
            txtarea.selectionEnd = strPos;
            txtarea.focus();
        }
        txtarea.scrollTop = scrollPos;
    }

    function ResourceLoader()
    {
      var AdditionalData = "";
      var IsString = true;
      var IsPrerender = false;

      this.Resolve = function(str)
      {
        var res = this.ResolveResources(str);
        //res = this.ResolveVariables(res);
        return res;
      }

      this.SetIsString = function(value)
      {
        IsString = value;
      }

      this.SetIsPrerender = function(value)
      {
        IsPrerender = value;
      }

      this.ResolveVariables = function(str)
      {
        var res = "";
        var reg = new RegExp("\\[\\[([^\\]]+)\\]\\]")
        var rest = str
        var all = ""
        while(true)
        {
          all = res
          if(res.length > 0 && rest.length > 0)
            all += ((IsString) ? " + " : "")

          if(rest.length > 0)
            all += ((IsString) ? "\"" : "") + ((IsString) ? je(rest) : rest) + ((IsString) ? "\"" : "")

          var match = reg.exec(rest)
          if(!match)
            break;

          var i = match.index
          var resnew = "";
          if(i>0)
          {
            resnew += (IsString) ? "\"" : ""
            resnew += (IsString) ? je(rest.substr(0,i)) : rest.substr(0,i)
            resnew += (IsString) ? "\" + " : ""
          }

          if(IsPrerender)
            resnew += match[0]
          else
            resnew += "VAR_" + match[1]


          i = match.index + match[0].length
          var j = rest.length - i
          if(j>0)
          {
            rest = rest.substr(i,j)
          }else
            rest = ""

          if(res.length == 0)
            res = resnew
          else
            res +=  ((IsString) ? " + " : "") + resnew


        }
        return all;
      }

      this.ResolveResources = function(str)
      {
        var res = "";
        var reg = new RegExp("\\{\\{([^\\}]+)\\}\\}")
        var rest = str
        var all = ""
        while(true)
        {
          all = res
          if(res.length > 0 && rest.length > 0)
            all += ((IsString) ? " + " : "")

          if(rest.length > 0)
            all += this.ResolveVariables(rest)

          var match = reg.exec(rest)
          if(!match)
            break;
          var Iteration = Math.floor(Math.random() * (999999 - 100000) + 100000)

          var v = "RESOURCE_" + Iteration;
          var m = match[1].split("|")[0]
          var notreuse = match[1].indexOf("|notreuse")>=0
          var onlyfail = match[1].indexOf("|onlyfail")>=0
          AdditionalData +=  _.template($('#resource_code').html())({resource:m,variable:v,notreuse:notreuse,onlyfail:onlyfail});

          var i = match.index
          var resnew = "";
          if(i>0)
          {
            resnew += this.ResolveVariables(rest.substr(0,i))
            resnew += ((IsString) ? " + " : "")
          }

          if(IsPrerender)
            resnew += match[0]
          else
            resnew += v

          i = match.index + match[0].length
          var j = rest.length - i
          if(j>0)
          {
            rest = rest.substr(i,j)
          }else
            rest = ""

          if(res.length == 0)
            res = resnew
          else
            res +=  ((IsString) ? " + " : "") + resnew


        }
        return all;
      }

      this.GetAdditionalData = function()
      {
        return AdditionalData;
      }

    }



    function BrowserAutomationStudio_Click(x, y)
    {
      _Router.navigate("#", true);
      _GobalModel.set("x",x.toString())
      _GobalModel.set("y",y.toString())
      _Router.navigate("#!/click", true);
    }

    function BrowserAutomationStudio_Move(x, y)
    {
      _Router.navigate("#", true);
      _GobalModel.set("x",x.toString())
      _GobalModel.set("y",y.toString())
      _Router.navigate("#!/move", true);
    }

    function BrowserAutomationStudio_MoveAndClick(x, y)
    {
      _GobalModel.set("x",x.toString())
      _GobalModel.set("y",y.toString())
      _Router.navigate("#!/moveandclick", true);
    }

    function BrowserAutomationStudio_ElementFunction(selector, name, is_loop)
    {
      _Router.navigate("#", true);
      if(is_loop !== 1)
      {
        _SelectorModel.set("css",selector["css"])
        _SelectorModel.set("match",selector["match"])
      }
      else
      {
        if(_.pluck(_VariableCollection.toJSON(), 'name').indexOf("FOR_EACH_CSS") < 0)
        {
          bootbox.alert(tr("Start Loop to use this function"))
          return
        }

        _SelectorModel.set("css","[[FOR_EACH_CSS]]<[[CYCLE_INDEX]]>")
        _SelectorModel.set("match","[[FOR_EACH_MATCH]]<[[CYCLE_INDEX]]>")
      }
      _SelectorModel.set("mousex",parseInt(selector["mousex"]))
      _SelectorModel.set("mousey",parseInt(selector["mousey"]))

      _Router.navigate("#!/" + name, true);
    }

    function BrowserAutomationStudio_LoopElement(selector)
    {
      BrowserAutomationStudio_ElementFunction(selector, "loopelement", false)
    }

    _MACRO_INSERT_ELEMENT_FUNCTION_

    function BrowserAutomationStudio_Wait(selector, is_loop)
    {
      BrowserAutomationStudio_ElementFunction(selector, "waitelement", is_loop)
    }

    function BrowserAutomationStudio_GetXml(selector, is_loop)
    {
      BrowserAutomationStudio_ElementFunction(selector, "xml", is_loop)
    }

    function BrowserAutomationStudio_GetText(selector, is_loop)
    {
      BrowserAutomationStudio_ElementFunction(selector, "text", is_loop)
    }

    function BrowserAutomationStudio_ExecuteScript(selector, is_loop)
    {
      BrowserAutomationStudio_ElementFunction(selector, "script", is_loop)
    }


    function BrowserAutomationStudio_ClickElement(selector, is_loop)
    {
      BrowserAutomationStudio_ElementFunction(selector, "clickelement", is_loop)
    }
    function BrowserAutomationStudio_MoveElement(selector, is_loop)
    {
      BrowserAutomationStudio_ElementFunction(selector, "moveelement", is_loop)
    }
    function BrowserAutomationStudio_MoveAndClickElement(selector, is_loop)
    {
      BrowserAutomationStudio_ElementFunction(selector, "moveandclickelement", is_loop)
    }
    function BrowserAutomationStudio_Clear(selector, is_loop)
    {
      BrowserAutomationStudio_ElementFunction(selector, "clear", is_loop)
    }
    function BrowserAutomationStudio_Type(selector, is_loop)
    {
      BrowserAutomationStudio_ElementFunction(selector, "typeelement", is_loop)
    }
    function BrowserAutomationStudio_Exists(selector, is_loop)
    {
      BrowserAutomationStudio_ElementFunction(selector, "exist", is_loop)
    }
    function BrowserAutomationStudio_Style(selector, is_loop)
    {
      BrowserAutomationStudio_ElementFunction(selector, "style", is_loop)
    }
    function BrowserAutomationStudio_Check(selector, is_loop)
    {
      BrowserAutomationStudio_ElementFunction(selector, "check", is_loop)
    }
    function BrowserAutomationStudio_Focus(selector, is_loop)
    {
      BrowserAutomationStudio_ElementFunction(selector, "focus", is_loop)
    }
    function BrowserAutomationStudio_Set(selector, is_loop)
    {
      BrowserAutomationStudio_ElementFunction(selector, "set", is_loop)
    }
    function BrowserAutomationStudio_SetInteger(selector, is_loop)
    {
      BrowserAutomationStudio_ElementFunction(selector, "set_integer", is_loop)
    }
    function BrowserAutomationStudio_SetRandom(selector, is_loop)
    {
      BrowserAutomationStudio_ElementFunction(selector, "set_random", is_loop)
    }
    function BrowserAutomationStudio_GetAttr(selector, is_loop)
    {
      BrowserAutomationStudio_ElementFunction(selector, "attr", is_loop)
    }
    function BrowserAutomationStudio_SetAttr(selector, is_loop)
    {
      BrowserAutomationStudio_ElementFunction(selector, "set_attr", is_loop)
    }
    function BrowserAutomationStudio_Captcha(selector, is_loop)
    {
      BrowserAutomationStudio_ElementFunction(selector, "captcha", is_loop)
    }
    function BrowserAutomationStudio_Length(selector)
    {
      BrowserAutomationStudio_ElementFunction(selector, "length", false)
    }

    function Normalize(code, tab)
    {
      var a = code.split("\n")
      var res = "";
      for(var i=0;i<a.length;i+=1)
      {
        var l = a[i].trim()
        if(l.length == 0)
          continue;

        if(res.length != 0)
        {
          res += "\n"
        }
        for(var j = 0;j<tab;j+=1)
          res += "   "
        res += l
      }
      return res
    }


  </script>

</body>
</html>
